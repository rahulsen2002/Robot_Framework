<html>
<head>
<title>window.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #5f826b; font-style: italic;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
window.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright 2008-2011 Nokia Networks</span>
<span class="s0"># Copyright 2011-2016 Ryan Tomac, Ed Manlove and contributors</span>
<span class="s0"># Copyright 2016-     Robot Framework Foundation</span>
<span class="s0">#</span>
<span class="s0"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="s0"># you may not use this file except in compliance with the License.</span>
<span class="s0"># You may obtain a copy of the License at</span>
<span class="s0">#</span>
<span class="s0">#    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="s0">#</span>
<span class="s0"># Unless required by applicable law or agreed to in writing, software</span>
<span class="s0"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="s0"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="s0"># See the License for the specific language governing permissions and</span>
<span class="s0"># limitations under the License.</span>
<span class="s2">import </span><span class="s1">time</span>
<span class="s2">from </span><span class="s1">typing </span><span class="s2">import </span><span class="s1">Optional</span><span class="s3">, </span><span class="s1">List</span><span class="s3">, </span><span class="s1">Tuple</span><span class="s3">, </span><span class="s1">Union</span>

<span class="s2">from </span><span class="s1">SeleniumLibrary</span><span class="s3">.</span><span class="s1">utils </span><span class="s2">import </span><span class="s1">is_truthy</span><span class="s3">, </span><span class="s1">is_falsy</span><span class="s3">, </span><span class="s1">timestr_to_secs</span>
<span class="s2">from </span><span class="s1">selenium</span><span class="s3">.</span><span class="s1">common</span><span class="s3">.</span><span class="s1">exceptions </span><span class="s2">import </span><span class="s1">NoSuchWindowException</span>

<span class="s2">from </span><span class="s1">SeleniumLibrary</span><span class="s3">.</span><span class="s1">base </span><span class="s2">import </span><span class="s1">keyword</span><span class="s3">, </span><span class="s1">LibraryComponent</span>
<span class="s2">from </span><span class="s1">SeleniumLibrary</span><span class="s3">.</span><span class="s1">locators </span><span class="s2">import </span><span class="s1">WindowManager</span>
<span class="s2">from </span><span class="s1">SeleniumLibrary</span><span class="s3">.</span><span class="s1">utils </span><span class="s2">import </span><span class="s1">plural_or_not</span><span class="s3">, </span><span class="s1">is_string</span>


<span class="s2">class </span><span class="s1">WindowKeywords</span><span class="s3">(</span><span class="s1">LibraryComponent</span><span class="s3">):</span>
    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ctx</span><span class="s3">):</span>
        <span class="s1">LibraryComponent</span><span class="s3">.</span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">ctx</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_window_manager </span><span class="s3">= </span><span class="s1">WindowManager</span><span class="s3">(</span><span class="s1">ctx</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">switch_window</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">locator</span><span class="s3">: </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">list</span><span class="s3">, </span><span class="s1">str</span><span class="s3">] = </span><span class="s4">&quot;MAIN&quot;</span><span class="s3">,</span>
        <span class="s1">timeout</span><span class="s3">: </span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">str</span><span class="s3">] = </span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">browser</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;CURRENT&quot;</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Switches to browser window matching ``locator``. 
 
        If the window is found, all subsequent commands use the selected 
        window, until this keyword is used again. If the window is not 
        found, this keyword fails. The previous windows handle is returned 
        and can be used to switch back to it later. 
 
        Notice that alerts should be handled with 
        `Handle Alert` or other alert related keywords. 
 
        The ``locator`` can be specified using different strategies somewhat 
        similarly as when `locating elements` on pages. 
 
        - By default, the ``locator`` is matched against window handle, name, 
          title, and URL. Matching is done in that order and the first 
          matching window is selected. 
 
        - The ``locator`` can specify an explicit strategy by using the format 
          ``strategy:value`` (recommended) or ``strategy=value``. Supported 
          strategies are ``name``, ``title``, and ``url``. These matches windows 
          using their name, title, or URL, respectively. Additionally, ``default`` 
          can be used to explicitly use the default strategy explained above. 
 
        - If the ``locator`` is ``NEW`` (case-insensitive), the latest 
          opened window is selected. It is an error if this is the same 
          as the current window. 
 
        - If the ``locator`` is ``MAIN`` (default, case-insensitive), 
          the main window is selected. 
 
        - If the ``locator`` is ``CURRENT`` (case-insensitive), nothing is 
          done. This effectively just returns the current window handle. 
 
        - If the ``locator`` is not a string, it is expected to be a list 
          of window handles _to exclude_. Such a list of excluded windows 
          can be got from `Get Window Handles` before doing an action that 
          opens a new window. 
 
        The ``timeout`` is used to specify how long keyword will poll to select 
        the new window. The ``timeout`` is new in SeleniumLibrary 3.2. 
 
        Example: 
        | `Click Link`      | popup1      |      | # Open new window | 
        | `Switch Window`   | example     |      | # Select window using default strategy | 
        | `Title Should Be` | Pop-up 1    |      | 
        | `Click Button`    | popup2      |      | # Open another window | 
        | ${handle} = | `Switch Window`   | NEW  | # Select latest opened window | 
        | `Title Should Be` | Pop-up 2    |      | 
        | `Switch Window`   | ${handle}   |      | # Select window using handle | 
        | `Title Should Be` | Pop-up 1    |      | 
        | `Switch Window`   | MAIN        |      | # Select the main window | 
        | `Title Should Be` | Main        |      | 
        | ${excludes} = | `Get Window Handles` | | # Get list of current windows | 
        | `Click Link`      | popup3      |      | # Open one more window | 
        | `Switch Window`   | ${excludes} |      | # Select window using excludes | 
        | `Title Should Be` | Pop-up 3    |      | 
 
        The ``browser`` argument allows with ``index_or_alias`` to implicitly switch to 
        a specific browser when switching to a window. See `Switch Browser` 
 
        - If the ``browser`` is ``CURRENT`` (case-insensitive), no other browser is 
          selected. 
 
        *NOTE:* 
 
        - The ``strategy:value`` syntax is only supported by SeleniumLibrary 
          3.0 and newer. 
        - Prior to SeleniumLibrary 3.0 matching windows by name, title 
          and URL was case-insensitive. 
        - Earlier versions supported aliases ``None``, ``null`` and the 
          empty string for selecting the main window, and alias ``self`` 
          for selecting the current window. Support for these aliases was 
          removed in SeleniumLibrary 3.2. 
        &quot;&quot;&quot;</span>
        <span class="s1">epoch </span><span class="s3">= </span><span class="s1">time</span><span class="s3">.</span><span class="s1">time</span><span class="s3">()</span>
        <span class="s1">timeout </span><span class="s3">= </span><span class="s1">epoch </span><span class="s2">if </span><span class="s1">is_falsy</span><span class="s3">(</span><span class="s1">timeout</span><span class="s3">) </span><span class="s2">else </span><span class="s1">timestr_to_secs</span><span class="s3">(</span><span class="s1">timeout</span><span class="s3">) + </span><span class="s1">epoch</span>
        <span class="s2">try</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">current_window_handle</span>
        <span class="s2">except </span><span class="s1">NoSuchWindowException</span><span class="s3">:</span>
            <span class="s2">pass</span>
        <span class="s2">finally</span><span class="s3">:</span>
            <span class="s2">if not </span><span class="s1">is_string</span><span class="s3">(</span><span class="s1">browser</span><span class="s3">) </span><span class="s2">or not </span><span class="s1">browser</span><span class="s3">.</span><span class="s1">upper</span><span class="s3">() == </span><span class="s4">&quot;CURRENT&quot;</span><span class="s3">:</span>
                <span class="s1">self</span><span class="s3">.</span><span class="s1">drivers</span><span class="s3">.</span><span class="s1">switch</span><span class="s3">(</span><span class="s1">browser</span><span class="s3">)</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">_window_manager</span><span class="s3">.</span><span class="s1">select</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">timeout</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">close_window</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Closes currently opened and selected browser window/tab. &quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">close</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">get_window_handles</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">browser</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;CURRENT&quot;</span><span class="s3">) </span><span class="s1">-&gt; List</span><span class="s3">[</span><span class="s1">str</span><span class="s3">]:</span>
        <span class="s5">&quot;&quot;&quot;Returns all child window handles of the selected browser as a list. 
 
        Can be used as a list of windows to exclude with `Select Window`. 
 
        How to select the ``browser`` scope of this keyword, see `Get Locations`. 
 
        Prior to SeleniumLibrary 3.0, this keyword was named `List Windows`. 
        &quot;&quot;&quot;</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_window_manager</span><span class="s3">.</span><span class="s1">get_window_handles</span><span class="s3">(</span><span class="s1">browser</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">get_window_identifiers</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">browser</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;CURRENT&quot;</span><span class="s3">) </span><span class="s1">-&gt; List</span><span class="s3">:</span>
        <span class="s5">&quot;&quot;&quot;Returns and logs id attributes of all windows of the selected browser. 
 
        How to select the ``browser`` scope of this keyword, see `Get Locations`.&quot;&quot;&quot;</span>
        <span class="s1">ids </span><span class="s3">= [</span><span class="s1">info</span><span class="s3">.</span><span class="s1">id </span><span class="s2">for </span><span class="s1">info </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_window_manager</span><span class="s3">.</span><span class="s1">get_window_infos</span><span class="s3">(</span><span class="s1">browser</span><span class="s3">)]</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_log_list</span><span class="s3">(</span><span class="s1">ids</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">get_window_names</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">browser</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;CURRENT&quot;</span><span class="s3">) </span><span class="s1">-&gt; List</span><span class="s3">[</span><span class="s1">str</span><span class="s3">]:</span>
        <span class="s5">&quot;&quot;&quot;Returns and logs names of all windows of the selected browser. 
 
        How to select the ``browser`` scope of this keyword, see `Get Locations`.&quot;&quot;&quot;</span>
        <span class="s1">names </span><span class="s3">= [</span><span class="s1">info</span><span class="s3">.</span><span class="s1">name </span><span class="s2">for </span><span class="s1">info </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_window_manager</span><span class="s3">.</span><span class="s1">get_window_infos</span><span class="s3">(</span><span class="s1">browser</span><span class="s3">)]</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_log_list</span><span class="s3">(</span><span class="s1">names</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">get_window_titles</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">browser</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;CURRENT&quot;</span><span class="s3">) </span><span class="s1">-&gt; List</span><span class="s3">[</span><span class="s1">str</span><span class="s3">]:</span>
        <span class="s5">&quot;&quot;&quot;Returns and logs titles of all windows of the selected browser. 
 
        How to select the ``browser`` scope of this keyword, see `Get Locations`.&quot;&quot;&quot;</span>
        <span class="s1">titles </span><span class="s3">= [</span><span class="s1">info</span><span class="s3">.</span><span class="s1">title </span><span class="s2">for </span><span class="s1">info </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_window_manager</span><span class="s3">.</span><span class="s1">get_window_infos</span><span class="s3">(</span><span class="s1">browser</span><span class="s3">)]</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_log_list</span><span class="s3">(</span><span class="s1">titles</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">get_locations</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">browser</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;CURRENT&quot;</span><span class="s3">) </span><span class="s1">-&gt; List</span><span class="s3">[</span><span class="s1">str</span><span class="s3">]:</span>
        <span class="s5">&quot;&quot;&quot;Returns and logs URLs of all windows of the selected browser. 
 
        *Browser Scope:* 
 
        The ``browser`` argument specifies the browser that shall return 
        its windows information. 
 
        - ``browser`` can be ``index_or_alias`` like in `Switch Browser`. 
 
        - If ``browser`` is ``CURRENT`` (default, case-insensitive) 
          the currently active browser is selected. 
 
        - If ``browser`` is ``ALL`` (case-insensitive) 
          the window information of all windows of all opened browsers are returned.&quot;&quot;&quot;</span>
        <span class="s1">urls </span><span class="s3">= [</span><span class="s1">info</span><span class="s3">.</span><span class="s1">url </span><span class="s2">for </span><span class="s1">info </span><span class="s2">in </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_window_manager</span><span class="s3">.</span><span class="s1">get_window_infos</span><span class="s3">(</span><span class="s1">browser</span><span class="s3">)]</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_log_list</span><span class="s3">(</span><span class="s1">urls</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">maximize_browser_window</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Maximizes current browser window.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">maximize_window</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">minimize_browser_window</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Minimizes current browser window.&quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">minimize_window</span><span class="s3">()</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">get_window_size</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">inner</span><span class="s3">: </span><span class="s1">bool </span><span class="s3">= </span><span class="s2">False</span><span class="s3">) </span><span class="s1">-&gt; Tuple</span><span class="s3">[</span><span class="s1">float</span><span class="s3">, </span><span class="s1">float</span><span class="s3">]:</span>
        <span class="s5">&quot;&quot;&quot;Returns current window width and height as integers. 
 
        See also `Set Window Size`. 
 
        If ``inner`` parameter is set to True, keyword returns 
        HTML DOM window.innerWidth and window.innerHeight properties. 
        See `Boolean arguments` for more details on how to set boolean 
        arguments. The ``inner`` is new in SeleniumLibrary 4.0. 
 
        Example: 
        | ${width} | ${height}= | `Get Window Size` |      | 
        | ${width} | ${height}= | `Get Window Size` | True | 
        &quot;&quot;&quot;</span>
        <span class="s2">if </span><span class="s1">is_truthy</span><span class="s3">(</span><span class="s1">inner</span><span class="s3">):</span>
            <span class="s1">inner_width </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">execute_script</span><span class="s3">(</span><span class="s4">&quot;return window.innerWidth;&quot;</span><span class="s3">))</span>
            <span class="s1">inner_height </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">execute_script</span><span class="s3">(</span><span class="s4">&quot;return window.innerHeight;&quot;</span><span class="s3">))</span>
            <span class="s2">return </span><span class="s1">inner_width</span><span class="s3">, </span><span class="s1">inner_height</span>
        <span class="s1">size </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">get_window_size</span><span class="s3">()</span>
        <span class="s2">return </span><span class="s1">size</span><span class="s3">[</span><span class="s4">&quot;width&quot;</span><span class="s3">], </span><span class="s1">size</span><span class="s3">[</span><span class="s4">&quot;height&quot;</span><span class="s3">]</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">set_window_size</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">width</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">height</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">inner</span><span class="s3">: </span><span class="s1">bool </span><span class="s3">= </span><span class="s2">False</span><span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Sets current windows size to given ``width`` and ``height``. 
 
        Values can be given using strings containing numbers or by using 
        actual numbers. See also `Get Window Size`. 
 
        Browsers have a limit on their minimum size. Trying to set them 
        smaller will cause the actual size to be bigger than the requested 
        size. 
 
        If ``inner`` parameter is set to True, keyword sets the necessary 
        window width and height to have the desired HTML DOM _window.innerWidth_ 
        and _window.innerHeight_. See `Boolean arguments` for more details on how to set boolean 
        arguments. 
 
        The ``inner`` argument is new since SeleniumLibrary 4.0. 
 
        This ``inner`` argument does not support Frames. If a frame is selected, 
        switch to default before running this. 
 
        Example: 
        | `Set Window Size` | 800 | 600 |      | 
        | `Set Window Size` | 800 | 600 | True | 
        &quot;&quot;&quot;</span>
        <span class="s2">if </span><span class="s1">is_falsy</span><span class="s3">(</span><span class="s1">inner</span><span class="s3">):</span>
            <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">set_window_size</span><span class="s3">(</span><span class="s1">width</span><span class="s3">, </span><span class="s1">height</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">set_window_size</span><span class="s3">(</span><span class="s1">width</span><span class="s3">, </span><span class="s1">height</span><span class="s3">)</span>
        <span class="s1">inner_width </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">execute_script</span><span class="s3">(</span><span class="s4">&quot;return window.innerWidth;&quot;</span><span class="s3">))</span>
        <span class="s1">inner_height </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">execute_script</span><span class="s3">(</span><span class="s4">&quot;return window.innerHeight;&quot;</span><span class="s3">))</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">info</span><span class="s3">(</span>
            <span class="s4">f&quot;window.innerWidth is </span><span class="s2">{</span><span class="s1">inner_width</span><span class="s2">} </span><span class="s4">and window.innerHeight is </span><span class="s2">{</span><span class="s1">inner_height</span><span class="s2">}</span><span class="s4">&quot;</span>
        <span class="s3">)</span>
        <span class="s1">width_offset </span><span class="s3">= </span><span class="s1">width </span><span class="s3">- </span><span class="s1">inner_width</span>
        <span class="s1">height_offset </span><span class="s3">= </span><span class="s1">height </span><span class="s3">- </span><span class="s1">inner_height</span>
        <span class="s1">window_width </span><span class="s3">= </span><span class="s1">width </span><span class="s3">+ </span><span class="s1">width_offset</span>
        <span class="s1">window_height </span><span class="s3">= </span><span class="s1">height </span><span class="s3">+ </span><span class="s1">height_offset</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">info</span><span class="s3">(</span><span class="s4">f&quot;Setting window size to </span><span class="s2">{</span><span class="s1">window_width</span><span class="s2">} {</span><span class="s1">window_height</span><span class="s2">}</span><span class="s4">&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">set_window_size</span><span class="s3">(</span><span class="s1">window_width</span><span class="s3">, </span><span class="s1">window_height</span><span class="s3">)</span>
        <span class="s1">result_width </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">execute_script</span><span class="s3">(</span><span class="s4">&quot;return window.innerWidth;&quot;</span><span class="s3">))</span>
        <span class="s1">result_height </span><span class="s3">= </span><span class="s1">int</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">execute_script</span><span class="s3">(</span><span class="s4">&quot;return window.innerHeight;&quot;</span><span class="s3">))</span>
        <span class="s2">if </span><span class="s1">result_width </span><span class="s3">!= </span><span class="s1">width </span><span class="s2">or </span><span class="s1">result_height </span><span class="s3">!= </span><span class="s1">height</span><span class="s3">:</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span><span class="s4">&quot;Keyword failed setting correct window size.&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">get_window_position</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; Tuple</span><span class="s3">[</span><span class="s1">int</span><span class="s3">, </span><span class="s1">int</span><span class="s3">]:</span>
        <span class="s5">&quot;&quot;&quot;Returns current window position. 
 
        The position is relative to the top left corner of the screen. Returned 
        values are integers. See also `Set Window Position`. 
 
        Example: 
        | ${x} | ${y}= | `Get Window Position` | 
        &quot;&quot;&quot;</span>
        <span class="s1">position </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">get_window_position</span><span class="s3">()</span>
        <span class="s2">return </span><span class="s1">position</span><span class="s3">[</span><span class="s4">&quot;x&quot;</span><span class="s3">], </span><span class="s1">position</span><span class="s3">[</span><span class="s4">&quot;y&quot;</span><span class="s3">]</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">set_window_position</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">x</span><span class="s3">: </span><span class="s1">int</span><span class="s3">, </span><span class="s1">y</span><span class="s3">: </span><span class="s1">int</span><span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Sets window position using ``x`` and ``y`` coordinates. 
 
        The position is relative to the top left corner of the screen, 
        but some browsers exclude possible task bar set by the operating 
        system from the calculation. The actual position may thus be 
        different with different browsers. 
 
        Values can be given using strings containing numbers or by using 
        actual numbers. See also `Get Window Position`. 
 
        Example: 
        | `Set Window Position` | 100 | 200 | 
        &quot;&quot;&quot;</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">driver</span><span class="s3">.</span><span class="s1">set_window_position</span><span class="s3">(</span><span class="s1">x</span><span class="s3">, </span><span class="s1">y</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_log_list</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">items</span><span class="s3">, </span><span class="s1">what</span><span class="s3">=</span><span class="s4">&quot;item&quot;</span><span class="s3">):</span>
        <span class="s1">msg </span><span class="s3">= [</span><span class="s4">f&quot;Altogether </span><span class="s2">{</span><span class="s1">len</span><span class="s3">(</span><span class="s1">items</span><span class="s3">)</span><span class="s2">} {</span><span class="s1">what</span><span class="s2">}{</span><span class="s1">plural_or_not</span><span class="s3">(</span><span class="s1">items</span><span class="s3">)</span><span class="s2">}</span><span class="s4">.&quot;</span><span class="s3">]</span>
        <span class="s2">for </span><span class="s1">index</span><span class="s3">, </span><span class="s1">item </span><span class="s2">in </span><span class="s1">enumerate</span><span class="s3">(</span><span class="s1">items</span><span class="s3">):</span>
            <span class="s1">msg</span><span class="s3">.</span><span class="s1">append</span><span class="s3">(</span><span class="s4">f&quot;</span><span class="s2">{</span><span class="s1">index </span><span class="s3">+ </span><span class="s6">1</span><span class="s2">}</span><span class="s4">: </span><span class="s2">{</span><span class="s1">item</span><span class="s2">}</span><span class="s4">&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">info</span><span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\n</span><span class="s4">&quot;</span><span class="s3">.</span><span class="s1">join</span><span class="s3">(</span><span class="s1">msg</span><span class="s3">))</span>
        <span class="s2">return </span><span class="s1">items</span>
</pre>
</body>
</html>