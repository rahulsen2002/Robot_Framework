<html>
<head>
<title>view.js</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #7a7e85;}
.s5 { color: #42c3d4;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
view.js</font>
</center></td></tr></table>
<pre><span class="s0">const </span><span class="s1">lightModeIcon </span><span class="s2">= </span><span class="s3">`</span>
<span class="s3">&lt;svg class=&quot;light-mode-icon&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; enable-background=&quot;new 0 0 24 24&quot; 
    viewBox=&quot;0 0 24 24&quot; fill=&quot;var(--text-color)&quot;&gt; 
    &lt;rect fill=&quot;none&quot; height=&quot;24&quot; width=&quot;24&quot; /&gt; 
    &lt;path 
        d=&quot;M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0 c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2 c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1 C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06 c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41 l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41 c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36 c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z&quot; /&gt; 
&lt;/svg&gt;`</span>

<span class="s0">const </span><span class="s1">darkModeIcon </span><span class="s2">= </span><span class="s3">`</span>
<span class="s3">&lt;svg class=&quot;dark-mode-icon&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; enable-background=&quot;new 0 0 24 24&quot; 
    viewBox=&quot;0 0 24 24&quot; fill=&quot;var(--text-color)&quot;&gt; 
    &lt;rect fill=&quot;none&quot; height=&quot;24&quot; width=&quot;24&quot; /&gt; 
    &lt;path 
        d=&quot;M11.01,3.05C6.51,3.54,3,7.36,3,12c0,4.97,4.03,9,9,9c4.63,0,8.45-3.5,8.95-8c0.09-0.79-0.78-1.42-1.54-0.95 c-0.84,0.54-1.84,0.85-2.91,0.85c-2.98,0-5.4-2.42-5.4-5.4c0-1.06,0.31-2.06,0.84-2.89C12.39,3.94,11.9,2.98,11.01,3.05z&quot; /&gt; 
&lt;/svg&gt;`</span>


<span class="s0">function </span><span class="s1">removeJavaScriptDisabledWarning</span><span class="s2">() {</span>
    <span class="s4">// Not using jQuery here for maximum speed</span>
    <span class="s1">document</span><span class="s2">.</span><span class="s1">getElementById</span><span class="s2">(</span><span class="s3">'javascript-disabled'</span><span class="s2">).</span><span class="s1">style</span><span class="s2">.</span><span class="s1">display </span><span class="s2">= </span><span class="s3">'none'</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">addJavaScriptDisabledWarning</span><span class="s2">(</span><span class="s1">error</span><span class="s2">) {</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">window</span><span class="s2">.</span><span class="s1">console</span><span class="s2">)</span>
        <span class="s1">console</span><span class="s2">.</span><span class="s1">error</span><span class="s2">(</span><span class="s3">'Opening failed: ' </span><span class="s2">+ </span><span class="s1">error</span><span class="s2">.</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">': ' </span><span class="s2">+ </span><span class="s1">error</span><span class="s2">.</span><span class="s1">message</span><span class="s2">);</span>
    <span class="s1">document</span><span class="s2">.</span><span class="s1">getElementById</span><span class="s2">(</span><span class="s3">'javascript-disabled'</span><span class="s2">).</span><span class="s1">style</span><span class="s2">.</span><span class="s1">display </span><span class="s2">= </span><span class="s3">'block'</span><span class="s2">;</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">initLayout</span><span class="s2">(</span><span class="s1">suiteName</span><span class="s2">, </span><span class="s1">type</span><span class="s2">) {</span>
    <span class="s1">parseTemplates</span><span class="s2">();</span>
    <span class="s1">setTitle</span><span class="s2">(</span><span class="s1">suiteName</span><span class="s2">, </span><span class="s1">type</span><span class="s2">);</span>
    <span class="s1">addHeader</span><span class="s2">();</span>
    <span class="s1">addReportOrLogLink</span><span class="s2">(</span><span class="s1">type</span><span class="s2">);</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">parseTemplates</span><span class="s2">() {</span>
    <span class="s1">$</span><span class="s2">(</span><span class="s3">'script[type=&quot;text/x-jquery-tmpl&quot;]'</span><span class="s2">).</span><span class="s1">map</span><span class="s2">(</span><span class="s0">function </span><span class="s2">(</span><span class="s1">idx</span><span class="s2">, </span><span class="s1">elem</span><span class="s2">) {</span>
        <span class="s1">$</span><span class="s2">.</span><span class="s1">template</span><span class="s2">(</span><span class="s1">elem</span><span class="s2">.</span><span class="s1">id</span><span class="s2">, </span><span class="s1">elem</span><span class="s2">.</span><span class="s1">text</span><span class="s2">);</span>
    <span class="s2">});</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">testOrTask</span><span class="s2">(</span><span class="s1">text</span><span class="s2">) {</span>
    <span class="s0">return </span><span class="s1">text</span><span class="s2">.</span><span class="s1">replace</span><span class="s2">(</span><span class="s5">/{(.*)}/</span><span class="s2">, </span><span class="s0">function </span><span class="s2">(</span><span class="s1">match</span><span class="s2">, </span><span class="s1">group</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">, </span><span class="s1">string</span><span class="s2">) {</span>
        <span class="s0">if </span><span class="s2">(!</span><span class="s1">window</span><span class="s2">.</span><span class="s1">settings</span><span class="s2">.</span><span class="s1">rpa</span><span class="s2">)</span>
            <span class="s0">return </span><span class="s1">group</span><span class="s2">;</span>
        <span class="s0">return </span><span class="s2">{</span><span class="s3">'TEST'</span><span class="s2">: </span><span class="s3">'TASK'</span><span class="s2">, </span><span class="s3">'Test'</span><span class="s2">: </span><span class="s3">'Task'</span><span class="s2">, </span><span class="s3">'test'</span><span class="s2">: </span><span class="s3">'task'</span><span class="s2">}[</span><span class="s1">group</span><span class="s2">];</span>
    <span class="s2">});</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">setTitle</span><span class="s2">(</span><span class="s1">suiteName</span><span class="s2">, </span><span class="s1">type</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">givenTitle </span><span class="s2">= </span><span class="s1">window</span><span class="s2">.</span><span class="s1">settings</span><span class="s2">.</span><span class="s1">title</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">title </span><span class="s2">= </span><span class="s1">givenTitle </span><span class="s2">? </span><span class="s1">givenTitle </span><span class="s2">: </span><span class="s1">suiteName </span><span class="s2">+ </span><span class="s3">&quot; &quot; </span><span class="s2">+ </span><span class="s1">type</span><span class="s2">;</span>
    <span class="s1">document</span><span class="s2">.</span><span class="s1">title </span><span class="s2">= </span><span class="s1">util</span><span class="s2">.</span><span class="s1">unescape</span><span class="s2">(</span><span class="s1">title</span><span class="s2">);</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">addHeader</span><span class="s2">() {</span>
    <span class="s0">var </span><span class="s1">generated </span><span class="s2">= </span><span class="s1">util</span><span class="s2">.</span><span class="s1">timestamp</span><span class="s2">(</span><span class="s1">window</span><span class="s2">.</span><span class="s1">output</span><span class="s2">.</span><span class="s1">generated</span><span class="s2">);</span>
    <span class="s1">$</span><span class="s2">.</span><span class="s1">tmpl</span><span class="s2">(</span><span class="s3">'&lt;h1&gt;${title}&lt;/h1&gt;' </span><span class="s2">+</span>
           <span class="s3">'&lt;button id=theme-toggle&gt;' </span><span class="s2">+</span>
             <span class="s1">lightModeIcon </span><span class="s2">+</span>
             <span class="s1">darkModeIcon </span><span class="s2">+</span>
           <span class="s3">'&lt;/button&gt;' </span><span class="s2">+</span>
           <span class="s3">'&lt;div id=&quot;generated&quot;&gt;' </span><span class="s2">+</span>
             <span class="s3">'&lt;span&gt;Generated&lt;br&gt;${generated}&lt;/span&gt;&lt;br&gt;' </span><span class="s2">+</span>
             <span class="s3">'&lt;span id=&quot;generated-ago&quot;&gt;${ago} ago&lt;/span&gt;' </span><span class="s2">+</span>
           <span class="s3">'&lt;/div&gt;' </span><span class="s2">+</span>
           <span class="s3">'&lt;div id=&quot;top-right-header&quot;&gt;' </span><span class="s2">+</span>
             <span class="s3">'&lt;div id=&quot;report-or-log-link&quot;&gt;&lt;a href=&quot;#&quot;&gt;&lt;/a&gt;&lt;/div&gt;' </span><span class="s2">+</span>
           <span class="s3">'&lt;/div&gt;'</span><span class="s2">, {</span>
        <span class="s1">generated</span><span class="s2">: </span><span class="s1">util</span><span class="s2">.</span><span class="s1">createGeneratedString</span><span class="s2">(</span><span class="s1">generated</span><span class="s2">),</span>
        <span class="s1">ago</span><span class="s2">: </span><span class="s1">util</span><span class="s2">.</span><span class="s1">createGeneratedAgoString</span><span class="s2">(</span><span class="s1">generated</span><span class="s2">),</span>
        <span class="s1">title</span><span class="s2">: </span><span class="s1">document</span><span class="s2">.</span><span class="s1">title</span>
    <span class="s2">}).</span><span class="s1">appendTo</span><span class="s2">(</span><span class="s1">$</span><span class="s2">(</span><span class="s3">'#header'</span><span class="s2">));</span>
    <span class="s1">document</span><span class="s2">.</span><span class="s1">getElementById</span><span class="s2">(</span><span class="s3">'theme-toggle'</span><span class="s2">)?.</span><span class="s1">addEventListener</span><span class="s2">(</span><span class="s3">'click'</span><span class="s2">, </span><span class="s1">theme</span><span class="s2">.</span><span class="s1">onClick</span><span class="s2">);</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">addReportOrLogLink</span><span class="s2">(</span><span class="s1">myType</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">url</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">text</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">container </span><span class="s2">= </span><span class="s1">$</span><span class="s2">(</span><span class="s3">'#report-or-log-link'</span><span class="s2">);</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">myType </span><span class="s2">== </span><span class="s3">'Report'</span><span class="s2">) {</span>
        <span class="s1">url </span><span class="s2">= </span><span class="s1">window</span><span class="s2">.</span><span class="s1">settings</span><span class="s2">.</span><span class="s1">logURL</span><span class="s2">;</span>
        <span class="s1">text </span><span class="s2">= </span><span class="s3">'LOG'</span><span class="s2">;</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
        <span class="s1">url </span><span class="s2">= </span><span class="s1">window</span><span class="s2">.</span><span class="s1">settings</span><span class="s2">.</span><span class="s1">reportURL</span><span class="s2">;</span>
        <span class="s1">text </span><span class="s2">= </span><span class="s3">'REPORT'</span><span class="s2">;</span>
    <span class="s2">}</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">url</span><span class="s2">) {</span>
        <span class="s1">container</span><span class="s2">.</span><span class="s1">find</span><span class="s2">(</span><span class="s3">'a'</span><span class="s2">).</span><span class="s1">attr</span><span class="s2">(</span><span class="s3">'href'</span><span class="s2">, </span><span class="s1">url</span><span class="s2">);</span>
        <span class="s1">container</span><span class="s2">.</span><span class="s1">find</span><span class="s2">(</span><span class="s3">'a'</span><span class="s2">).</span><span class="s1">text</span><span class="s2">(</span><span class="s1">text</span><span class="s2">);</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
        <span class="s1">container</span><span class="s2">.</span><span class="s1">remove</span><span class="s2">();</span>
    <span class="s2">}</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">addStatistics</span><span class="s2">() {</span>
    <span class="s0">var </span><span class="s1">statHeaders </span><span class="s2">=</span>
        <span class="s3">'&lt;th class=&quot;stats-col-stat&quot;&gt;Total&lt;/th&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;th class=&quot;stats-col-stat&quot;&gt;Pass&lt;/th&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;th class=&quot;stats-col-stat&quot;&gt;Fail&lt;/th&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;th class=&quot;stats-col-stat&quot;&gt;Skip&lt;/th&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;th class=&quot;stats-col-elapsed&quot;&gt;Elapsed&lt;/th&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;th class=&quot;stats-col-graph&quot;&gt;Pass / Fail / Skip&lt;/th&gt;'</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">statTable </span><span class="s2">=</span>
        <span class="s3">'&lt;h2&gt;{Test} Statistics&lt;/h2&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;table class=&quot;statistics&quot; id=&quot;total-stats&quot;&gt;&lt;thead&gt;&lt;tr&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;th class=&quot;stats-col-name&quot;&gt;Total Statistics&lt;/th&gt;' </span><span class="s2">+ </span><span class="s1">statHeaders </span><span class="s2">+</span>
        <span class="s3">'&lt;/tr&gt;&lt;/thead&gt;&lt;/table&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;table class=&quot;statistics&quot; id=&quot;tag-stats&quot;&gt;&lt;thead&gt;&lt;tr&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;th class=&quot;stats-col-name&quot;&gt;Statistics by Tag&lt;/th&gt;' </span><span class="s2">+ </span><span class="s1">statHeaders </span><span class="s2">+</span>
        <span class="s3">'&lt;/tr&gt;&lt;/thead&gt;&lt;/table&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;table class=&quot;statistics&quot; id=&quot;suite-stats&quot;&gt;&lt;thead&gt;&lt;tr&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;th class=&quot;stats-col-name&quot;&gt;Statistics by Suite&lt;/th&gt;' </span><span class="s2">+ </span><span class="s1">statHeaders </span><span class="s2">+</span>
        <span class="s3">'&lt;/tr&gt;&lt;/thead&gt;&lt;/table&gt;'</span><span class="s2">;</span>
    <span class="s1">$</span><span class="s2">(</span><span class="s1">testOrTask</span><span class="s2">(</span><span class="s1">statTable</span><span class="s2">)).</span><span class="s1">appendTo</span><span class="s2">(</span><span class="s3">'#statistics-container'</span><span class="s2">);</span>
    <span class="s1">util</span><span class="s2">.</span><span class="s1">map</span><span class="s2">([</span><span class="s3">'total'</span><span class="s2">, </span><span class="s3">'tag'</span><span class="s2">, </span><span class="s3">'suite'</span><span class="s2">], </span><span class="s1">addStatTable</span><span class="s2">);</span>
    <span class="s1">addTooltipsToElapsedTimes</span><span class="s2">();</span>
    <span class="s1">enableStatisticsSorter</span><span class="s2">();</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">addTooltipsToElapsedTimes</span><span class="s2">() {</span>
    <span class="s1">$</span><span class="s2">(</span><span class="s3">'.stats-col-elapsed'</span><span class="s2">).</span><span class="s1">attr</span><span class="s2">(</span><span class="s3">'title'</span><span class="s2">,</span>
        <span class="s1">testOrTask</span><span class="s2">(</span><span class="s3">'Total execution time of these {test}s. '</span><span class="s2">) +</span>
        <span class="s3">'Excludes suite setups and teardowns.'</span><span class="s2">);</span>
    <span class="s1">$</span><span class="s2">(</span><span class="s3">'#suite-stats'</span><span class="s2">).</span><span class="s1">find</span><span class="s2">(</span><span class="s3">'.stats-col-elapsed'</span><span class="s2">).</span><span class="s1">attr</span><span class="s2">(</span><span class="s3">'title'</span><span class="s2">,</span>
        <span class="s3">'Total execution time of this suite.'</span><span class="s2">);</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">enableStatisticsSorter</span><span class="s2">() {</span>
    <span class="s1">$</span><span class="s2">.</span><span class="s1">tablesorter</span><span class="s2">.</span><span class="s1">addParser</span><span class="s2">({</span>
        <span class="s1">id</span><span class="s2">: </span><span class="s3">'statName'</span><span class="s2">,</span>
        <span class="s1">type</span><span class="s2">: </span><span class="s3">'numeric'</span><span class="s2">,</span>
        <span class="s1">is</span><span class="s2">: </span><span class="s0">function</span><span class="s2">(</span><span class="s1">s</span><span class="s2">) {</span>
            <span class="s0">return false</span><span class="s2">;  </span><span class="s4">// do not auto-detect</span>
        <span class="s2">},</span>
        <span class="s1">format</span><span class="s2">: </span><span class="s0">function</span><span class="s2">(</span><span class="s1">string</span><span class="s2">, </span><span class="s1">table</span><span class="s2">, </span><span class="s1">cell</span><span class="s2">, </span><span class="s1">cellIndex</span><span class="s2">) {</span>
            <span class="s4">// Rows have class in format 'row-&lt;index&gt;'.</span>
            <span class="s0">var </span><span class="s1">index </span><span class="s2">= </span><span class="s1">$</span><span class="s2">(</span><span class="s1">cell</span><span class="s2">).</span><span class="s1">parent</span><span class="s2">().</span><span class="s1">attr</span><span class="s2">(</span><span class="s3">'class'</span><span class="s2">).</span><span class="s1">substring</span><span class="s2">(</span><span class="s6">4</span><span class="s2">);</span>
            <span class="s0">return </span><span class="s1">parseInt</span><span class="s2">(</span><span class="s1">index</span><span class="s2">);</span>
        <span class="s2">}</span>
    <span class="s2">});</span>
    <span class="s1">$</span><span class="s2">(</span><span class="s3">&quot;.statistics&quot;</span><span class="s2">).</span><span class="s1">tablesorter</span><span class="s2">({</span>
        <span class="s1">sortInitialOrder</span><span class="s2">: </span><span class="s3">'desc'</span><span class="s2">,</span>
        <span class="s1">headers</span><span class="s2">: {</span><span class="s6">0</span><span class="s2">: {</span><span class="s1">sorter</span><span class="s2">: </span><span class="s3">'statName'</span><span class="s2">, </span><span class="s1">sortInitialOrder</span><span class="s2">: </span><span class="s3">'asc'</span><span class="s2">},</span>
                  <span class="s6">6</span><span class="s2">: {</span><span class="s1">sorter</span><span class="s2">: </span><span class="s0">false</span><span class="s2">}}</span>
    <span class="s2">});</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">addStatTable</span><span class="s2">(</span><span class="s1">tableName</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">stats </span><span class="s2">= </span><span class="s1">window</span><span class="s2">.</span><span class="s1">testdata</span><span class="s2">.</span><span class="s1">statistics</span><span class="s2">()[</span><span class="s1">tableName</span><span class="s2">];</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">tableName </span><span class="s2">== </span><span class="s3">'tag' </span><span class="s2">&amp;&amp; </span><span class="s1">stats</span><span class="s2">.</span><span class="s1">length </span><span class="s2">== </span><span class="s6">0</span><span class="s2">) {</span>
        <span class="s1">renderNoTagStatTable</span><span class="s2">();</span>
    <span class="s2">} </span><span class="s0">else </span><span class="s2">{</span>
        <span class="s1">renderStatTable</span><span class="s2">(</span><span class="s1">tableName</span><span class="s2">, </span><span class="s1">stats</span><span class="s2">);</span>
    <span class="s2">}</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">renderNoTagStatTable</span><span class="s2">() {</span>
    <span class="s1">$</span><span class="s2">(</span><span class="s3">'&lt;tbody&gt;&lt;tr class=&quot;row-0&quot;&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;td class=&quot;stats-col-name&quot;&gt;No Tags&lt;/td&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;td class=&quot;stats-col-stat&quot;&gt;&lt;/td&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;td class=&quot;stats-col-stat&quot;&gt;&lt;/td&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;td class=&quot;stats-col-stat&quot;&gt;&lt;/td&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;td class=&quot;stats-col-stat&quot;&gt;&lt;/td&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;td class=&quot;stats-col-elapsed&quot;&gt;&lt;/td&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;td class=&quot;stats-col-graph&quot;&gt;' </span><span class="s2">+</span>
          <span class="s3">'&lt;div class=&quot;empty-graph&quot;&gt;&lt;/div&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;/td&gt;' </span><span class="s2">+</span>
      <span class="s3">'&lt;/tr&gt;&lt;/tbody&gt;'</span><span class="s2">).</span><span class="s1">appendTo</span><span class="s2">(</span><span class="s3">'#tag-stats'</span><span class="s2">);</span>
<span class="s2">}</span>

<span class="s0">function </span><span class="s1">renderStatTable</span><span class="s2">(</span><span class="s1">tableName</span><span class="s2">, </span><span class="s1">stats</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">template </span><span class="s2">= </span><span class="s1">tableName </span><span class="s2">+ </span><span class="s3">'StatisticsRowTemplate'</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">tbody </span><span class="s2">= </span><span class="s1">$</span><span class="s2">(</span><span class="s3">'&lt;tbody&gt;&lt;/tbody&gt;'</span><span class="s2">);</span>
    <span class="s0">for </span><span class="s2">(</span><span class="s0">var </span><span class="s1">i </span><span class="s2">= </span><span class="s6">0</span><span class="s2">, </span><span class="s1">len </span><span class="s2">= </span><span class="s1">stats</span><span class="s2">.</span><span class="s1">length</span><span class="s2">; </span><span class="s1">i </span><span class="s2">&lt; </span><span class="s1">len</span><span class="s2">; </span><span class="s1">i</span><span class="s2">++) {</span>
        <span class="s1">$</span><span class="s2">.</span><span class="s1">tmpl</span><span class="s2">(</span><span class="s1">template</span><span class="s2">, </span><span class="s1">stats</span><span class="s2">[</span><span class="s1">i</span><span class="s2">], {</span><span class="s1">index</span><span class="s2">: </span><span class="s1">i</span><span class="s2">}).</span><span class="s1">appendTo</span><span class="s2">(</span><span class="s1">tbody</span><span class="s2">);</span>
    <span class="s2">}</span>
    <span class="s1">tbody</span><span class="s2">.</span><span class="s1">appendTo</span><span class="s2">(</span><span class="s3">'#' </span><span class="s2">+ </span><span class="s1">tableName </span><span class="s2">+ </span><span class="s3">'-stats'</span><span class="s2">);</span>
<span class="s2">}</span>

<span class="s1">$</span><span class="s2">.</span><span class="s1">template</span><span class="s2">(</span><span class="s3">'statColumnsTemplate'</span><span class="s2">,</span>
    <span class="s3">'&lt;td class=&quot;stats-col-stat&quot;&gt;${total}&lt;/td&gt;' </span><span class="s2">+</span>
    <span class="s3">'&lt;td class=&quot;stats-col-stat&quot;&gt;${pass}&lt;/td&gt;' </span><span class="s2">+</span>
    <span class="s3">'&lt;td class=&quot;stats-col-stat&quot;&gt;${fail}&lt;/td&gt;' </span><span class="s2">+</span>
    <span class="s3">'&lt;td class=&quot;stats-col-stat&quot;&gt;${skip}&lt;/td&gt;' </span><span class="s2">+</span>
    <span class="s3">'&lt;td class=&quot;stats-col-elapsed&quot;&gt;${elapsed}&lt;/td&gt;' </span><span class="s2">+</span>
    <span class="s3">'&lt;td class=&quot;stats-col-graph&quot;&gt;' </span><span class="s2">+</span>
      <span class="s3">'{{if total}}' </span><span class="s2">+</span>
      <span class="s3">'&lt;div class=&quot;graph&quot;&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;div class=&quot;pass-bar&quot; style=&quot;width: ${passWidth}%&quot; title=&quot;${passPercent}%&quot;&gt;&lt;/div&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;div class=&quot;fail-bar&quot; style=&quot;width: ${failWidth}%&quot; title=&quot;${failPercent}%&quot;&gt;&lt;/div&gt;' </span><span class="s2">+</span>
        <span class="s3">'&lt;div class=&quot;skip-bar&quot; style=&quot;width: ${skipWidth}%&quot; title=&quot;${skipPercent}%&quot;&gt;&lt;/div&gt;' </span><span class="s2">+</span>
      <span class="s3">'&lt;/div&gt;' </span><span class="s2">+</span>
      <span class="s3">'{{else}}' </span><span class="s2">+</span>
      <span class="s3">'&lt;div class=&quot;empty-graph&quot;&gt;&lt;/div&gt;' </span><span class="s2">+</span>
      <span class="s3">'{{/if}}' </span><span class="s2">+</span>
    <span class="s3">'&lt;/td&gt;'</span>
<span class="s2">);</span>

<span class="s1">$</span><span class="s2">.</span><span class="s1">template</span><span class="s2">(</span><span class="s3">'suiteStatusMessageTemplate'</span><span class="s2">,</span>
    <span class="s3">'${total} {{= testOrTask(&quot;{test}&quot;)}}{{if total != 1}}s{{/if}} total, ' </span><span class="s2">+</span>
    <span class="s3">'${pass} passed, ${fail} failed, ${skip} skipped'</span>
<span class="s2">);</span>

<span class="s4">// For complete cross-browser experience..</span>
<span class="s4">// http://www.quirksmode.org/js/events_order.html</span>
<span class="s0">function </span><span class="s1">stopPropagation</span><span class="s2">(</span><span class="s1">event</span><span class="s2">) {</span>
    <span class="s0">var </span><span class="s1">event </span><span class="s2">= </span><span class="s1">event </span><span class="s2">|| </span><span class="s1">window</span><span class="s2">.</span><span class="s1">event</span><span class="s2">;</span>
    <span class="s1">event</span><span class="s2">.</span><span class="s1">cancelBubble </span><span class="s2">= </span><span class="s0">true</span><span class="s2">;</span>
    <span class="s0">if </span><span class="s2">(</span><span class="s1">event</span><span class="s2">.</span><span class="s1">stopPropagation</span><span class="s2">)</span>
        <span class="s1">event</span><span class="s2">.</span><span class="s1">stopPropagation</span><span class="s2">();</span>
<span class="s2">}</span>


<span class="s0">const </span><span class="s1">theme </span><span class="s2">= </span><span class="s0">function </span><span class="s2">() {</span>

    <span class="s0">const </span><span class="s1">storageKey </span><span class="s2">= </span><span class="s3">'theme-preference'</span><span class="s2">;</span>
    <span class="s0">const </span><span class="s1">urlParams </span><span class="s2">= </span><span class="s0">new </span><span class="s1">URLSearchParams</span><span class="s2">(</span><span class="s1">window</span><span class="s2">.</span><span class="s1">location</span><span class="s2">.</span><span class="s1">search</span><span class="s2">);</span>
    <span class="s0">var </span><span class="s1">storage</span><span class="s2">;</span>
    <span class="s0">var </span><span class="s1">theme</span><span class="s2">;</span>

    <span class="s0">function </span><span class="s1">init</span><span class="s2">(</span><span class="s1">givenStorage</span><span class="s2">) {</span>
        <span class="s1">storage </span><span class="s2">= </span><span class="s1">givenStorage</span><span class="s2">;</span>
        <span class="s1">theme </span><span class="s2">= { </span><span class="s1">value</span><span class="s2">: </span><span class="s1">getPreference</span><span class="s2">() };</span>
        <span class="s1">document</span><span class="s2">.</span><span class="s1">body</span><span class="s2">.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s3">'data-theme'</span><span class="s2">, </span><span class="s1">theme</span><span class="s2">.</span><span class="s1">value</span><span class="s2">);</span>
        <span class="s1">reflectPreference</span><span class="s2">();</span>

        <span class="s1">window</span><span class="s2">.</span><span class="s1">matchMedia</span><span class="s2">(</span><span class="s3">'(prefers-color-scheme: dark)'</span><span class="s2">)</span>
            <span class="s2">.</span><span class="s1">addEventListener</span><span class="s2">(</span><span class="s3">'change'</span><span class="s2">, ({</span><span class="s1">matches</span><span class="s2">:</span><span class="s1">isDark</span><span class="s2">}) =&gt; {</span>
                <span class="s1">theme</span><span class="s2">.</span><span class="s1">value </span><span class="s2">= </span><span class="s1">isDark </span><span class="s2">? </span><span class="s3">'dark' </span><span class="s2">: </span><span class="s3">'light'</span><span class="s2">;</span>
                <span class="s1">setPreference</span><span class="s2">();</span>
            <span class="s2">});</span>

        <span class="s1">window</span><span class="s2">.</span><span class="s1">addEventListener</span><span class="s2">(</span><span class="s3">'storage'</span><span class="s2">, ({</span><span class="s1">key</span><span class="s2">, </span><span class="s1">newValue</span><span class="s2">}) =&gt; {</span>
            <span class="s0">if </span><span class="s2">(</span><span class="s1">key </span><span class="s2">=== </span><span class="s1">storage</span><span class="s2">.</span><span class="s1">fullKey</span><span class="s2">(</span><span class="s1">storageKey</span><span class="s2">)) {</span>
                <span class="s1">theme</span><span class="s2">.</span><span class="s1">value </span><span class="s2">= </span><span class="s1">newValue </span><span class="s2">=== </span><span class="s3">'dark' </span><span class="s2">? </span><span class="s3">'dark' </span><span class="s2">: </span><span class="s3">'light'</span><span class="s2">;</span>
                <span class="s1">setPreference</span><span class="s2">();</span>
            <span class="s2">}</span>
        <span class="s2">});</span>
    <span class="s2">}</span>

    <span class="s0">function </span><span class="s1">getPreference</span><span class="s2">() {</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">urlParams</span><span class="s2">.</span><span class="s1">has</span><span class="s2">(</span><span class="s3">'theme'</span><span class="s2">)) {</span>
            <span class="s0">var </span><span class="s1">urlTheme </span><span class="s2">= </span><span class="s1">urlParams</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s3">'theme'</span><span class="s2">) === </span><span class="s3">'dark' </span><span class="s2">? </span><span class="s3">'dark' </span><span class="s2">: </span><span class="s3">'light'</span><span class="s2">;</span>
            <span class="s1">storage</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">storageKey</span><span class="s2">, </span><span class="s1">urlTheme</span><span class="s2">);</span>
            <span class="s1">urlParams</span><span class="s2">.</span><span class="s1">delete</span><span class="s2">(</span><span class="s3">'theme'</span><span class="s2">);</span>
            <span class="s0">return </span><span class="s1">urlTheme</span><span class="s2">;</span>
        <span class="s2">}</span>
        <span class="s0">if </span><span class="s2">(</span><span class="s1">storage</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">storageKey</span><span class="s2">))</span>
            <span class="s0">return </span><span class="s1">storage</span><span class="s2">.</span><span class="s1">get</span><span class="s2">(</span><span class="s1">storageKey</span><span class="s2">) === </span><span class="s3">'dark' </span><span class="s2">? </span><span class="s3">'dark' </span><span class="s2">: </span><span class="s3">'light'</span><span class="s2">;</span>
        <span class="s0">return </span><span class="s1">window</span><span class="s2">.</span><span class="s1">matchMedia</span><span class="s2">(</span><span class="s3">'(prefers-color-scheme: dark)'</span><span class="s2">).</span><span class="s1">matches </span><span class="s2">? </span><span class="s3">'dark' </span><span class="s2">: </span><span class="s3">'light'</span><span class="s2">;</span>
    <span class="s2">}</span>

    <span class="s0">function </span><span class="s1">setPreference</span><span class="s2">() {</span>
        <span class="s1">storage</span><span class="s2">.</span><span class="s1">set</span><span class="s2">(</span><span class="s1">storageKey</span><span class="s2">, </span><span class="s1">theme</span><span class="s2">.</span><span class="s1">value</span><span class="s2">);</span>
        <span class="s1">reflectPreference</span><span class="s2">();</span>
    <span class="s2">}</span>

    <span class="s0">function </span><span class="s1">reflectPreference</span><span class="s2">() {</span>
        <span class="s1">document</span><span class="s2">.</span><span class="s1">body</span><span class="s2">.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s3">'data-theme'</span><span class="s2">, </span><span class="s1">theme</span><span class="s2">.</span><span class="s1">value</span><span class="s2">);</span>
        <span class="s1">document</span><span class="s2">.</span><span class="s1">querySelector</span><span class="s2">(</span><span class="s3">'#theme-toggle'</span><span class="s2">)?.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s3">'aria-label'</span><span class="s2">, </span><span class="s1">theme</span><span class="s2">.</span><span class="s1">value</span><span class="s2">);</span>
        <span class="s0">const </span><span class="s1">event </span><span class="s2">= </span><span class="s0">new </span><span class="s1">Event</span><span class="s2">(</span><span class="s3">'theme-change'</span><span class="s2">, {</span><span class="s1">value</span><span class="s2">: </span><span class="s1">theme</span><span class="s2">.</span><span class="s1">value</span><span class="s2">});</span>
        <span class="s1">document</span><span class="s2">.</span><span class="s1">dispatchEvent</span><span class="s2">(</span><span class="s1">event</span><span class="s2">);</span>
    <span class="s2">}</span>

    <span class="s0">function </span><span class="s1">onClick</span><span class="s2">() {</span>
        <span class="s1">theme</span><span class="s2">.</span><span class="s1">value </span><span class="s2">= </span><span class="s1">theme</span><span class="s2">.</span><span class="s1">value </span><span class="s2">=== </span><span class="s3">'light' </span><span class="s2">? </span><span class="s3">'dark' </span><span class="s2">: </span><span class="s3">'light'</span><span class="s2">;</span>
        <span class="s1">document</span><span class="s2">.</span><span class="s1">body</span><span class="s2">.</span><span class="s1">setAttribute</span><span class="s2">(</span><span class="s3">'theme-toggled'</span><span class="s2">, </span><span class="s3">&quot;&quot;</span><span class="s2">);</span>
        <span class="s1">setPreference</span><span class="s2">();</span>
    <span class="s2">}</span>

    <span class="s0">return </span><span class="s2">{</span><span class="s1">init</span><span class="s2">: </span><span class="s1">init</span><span class="s2">, </span><span class="s1">getPreference</span><span class="s2">: </span><span class="s1">getPreference</span><span class="s2">, </span><span class="s1">setPreference</span><span class="s2">: </span><span class="s1">setPreference</span><span class="s2">,</span>
        <span class="s1">reflectPreference</span><span class="s2">: </span><span class="s1">reflectPreference</span><span class="s2">, </span><span class="s1">onClick</span><span class="s2">: </span><span class="s1">onClick</span><span class="s2">};</span>
<span class="s2">}();</span>
</pre>
</body>
</html>