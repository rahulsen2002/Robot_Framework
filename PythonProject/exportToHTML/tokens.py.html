<html>
<head>
<title>tokens.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #5f826b; font-style: italic;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
tokens.py</font>
</center></td></tr></table>
<pre><span class="s0">#  Copyright 2008-2015 Nokia Networks</span>
<span class="s0">#  Copyright 2016-     Robot Framework Foundation</span>
<span class="s0">#</span>
<span class="s0">#  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="s0">#  you may not use this file except in compliance with the License.</span>
<span class="s0">#  You may obtain a copy of the License at</span>
<span class="s0">#</span>
<span class="s0">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="s0">#</span>
<span class="s0">#  Unless required by applicable law or agreed to in writing, software</span>
<span class="s0">#  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="s0">#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="s0">#  See the License for the specific language governing permissions and</span>
<span class="s0">#  limitations under the License.</span>

<span class="s2">from </span><span class="s1">collections</span><span class="s3">.</span><span class="s1">abc </span><span class="s2">import </span><span class="s1">Iterator</span>
<span class="s2">from </span><span class="s1">typing </span><span class="s2">import </span><span class="s1">List</span>

<span class="s2">from </span><span class="s1">robot</span><span class="s3">.</span><span class="s1">variables </span><span class="s2">import </span><span class="s1">VariableMatches</span>

<span class="s0"># Type alias to ease typing elsewhere</span>
<span class="s1">StatementTokens </span><span class="s3">= </span><span class="s1">List</span><span class="s3">[</span><span class="s4">&quot;Token&quot;</span><span class="s3">]</span>


<span class="s2">class </span><span class="s1">Token</span><span class="s3">:</span>
    <span class="s5">&quot;&quot;&quot;Token representing piece of Robot Framework data. 
 
    Each token has type, value, line number, column offset and end column 
    offset in :attr:`type`, :attr:`value`, :attr:`lineno`, :attr:`col_offset` 
    and :attr:`end_col_offset` attributes, respectively. Tokens representing 
    error also have their error message in :attr:`error` attribute. 
 
    Token types are declared as class attributes such as :attr:`SETTING_HEADER` 
    and :attr:`EOL`. Values of these constants have changed slightly in Robot 
    Framework 4.0, and they may change again in the future. It is thus safer 
    to use the constants, not their values, when types are needed. For example, 
    use ``Token(Token.EOL)`` instead of ``Token('EOL')`` and 
    ``token.type == Token.EOL`` instead of ``token.type == 'EOL'``. 
 
    If :attr:`value` is not given and :attr:`type` is a special marker like 
    :attr:`IF` or `:attr:`EOL`, the value is set automatically. 
    &quot;&quot;&quot;</span>

    <span class="s1">SETTING_HEADER </span><span class="s3">= </span><span class="s4">&quot;SETTING HEADER&quot;</span>
    <span class="s1">VARIABLE_HEADER </span><span class="s3">= </span><span class="s4">&quot;VARIABLE HEADER&quot;</span>
    <span class="s1">TESTCASE_HEADER </span><span class="s3">= </span><span class="s4">&quot;TESTCASE HEADER&quot;</span>
    <span class="s1">TASK_HEADER </span><span class="s3">= </span><span class="s4">&quot;TASK HEADER&quot;</span>
    <span class="s1">KEYWORD_HEADER </span><span class="s3">= </span><span class="s4">&quot;KEYWORD HEADER&quot;</span>
    <span class="s1">COMMENT_HEADER </span><span class="s3">= </span><span class="s4">&quot;COMMENT HEADER&quot;</span>
    <span class="s1">INVALID_HEADER </span><span class="s3">= </span><span class="s4">&quot;INVALID HEADER&quot;</span>
    <span class="s1">FATAL_INVALID_HEADER </span><span class="s3">= </span><span class="s4">&quot;FATAL INVALID HEADER&quot;  </span><span class="s0"># TODO: Remove in RF 8.</span>

    <span class="s1">TESTCASE_NAME </span><span class="s3">= </span><span class="s4">&quot;TESTCASE NAME&quot;</span>
    <span class="s1">KEYWORD_NAME </span><span class="s3">= </span><span class="s4">&quot;KEYWORD NAME&quot;</span>
    <span class="s1">SUITE_NAME </span><span class="s3">= </span><span class="s4">&quot;SUITE NAME&quot;</span>
    <span class="s1">DOCUMENTATION </span><span class="s3">= </span><span class="s4">&quot;DOCUMENTATION&quot;</span>
    <span class="s1">SUITE_SETUP </span><span class="s3">= </span><span class="s4">&quot;SUITE SETUP&quot;</span>
    <span class="s1">SUITE_TEARDOWN </span><span class="s3">= </span><span class="s4">&quot;SUITE TEARDOWN&quot;</span>
    <span class="s1">METADATA </span><span class="s3">= </span><span class="s4">&quot;METADATA&quot;</span>
    <span class="s1">TEST_SETUP </span><span class="s3">= </span><span class="s4">&quot;TEST SETUP&quot;</span>
    <span class="s1">TEST_TEARDOWN </span><span class="s3">= </span><span class="s4">&quot;TEST TEARDOWN&quot;</span>
    <span class="s1">TEST_TEMPLATE </span><span class="s3">= </span><span class="s4">&quot;TEST TEMPLATE&quot;</span>
    <span class="s1">TEST_TIMEOUT </span><span class="s3">= </span><span class="s4">&quot;TEST TIMEOUT&quot;</span>
    <span class="s1">TEST_TAGS </span><span class="s3">= </span><span class="s4">&quot;TEST TAGS&quot;</span>
    <span class="s1">FORCE_TAGS </span><span class="s3">= </span><span class="s1">TEST_TAGS  </span><span class="s0"># TODO: Remove in RF 8.</span>
    <span class="s1">DEFAULT_TAGS </span><span class="s3">= </span><span class="s4">&quot;DEFAULT TAGS&quot;</span>
    <span class="s1">KEYWORD_TAGS </span><span class="s3">= </span><span class="s4">&quot;KEYWORD TAGS&quot;</span>
    <span class="s1">LIBRARY </span><span class="s3">= </span><span class="s4">&quot;LIBRARY&quot;</span>
    <span class="s1">RESOURCE </span><span class="s3">= </span><span class="s4">&quot;RESOURCE&quot;</span>
    <span class="s1">VARIABLES </span><span class="s3">= </span><span class="s4">&quot;VARIABLES&quot;</span>
    <span class="s1">SETUP </span><span class="s3">= </span><span class="s4">&quot;SETUP&quot;</span>
    <span class="s1">TEARDOWN </span><span class="s3">= </span><span class="s4">&quot;TEARDOWN&quot;</span>
    <span class="s1">TEMPLATE </span><span class="s3">= </span><span class="s4">&quot;TEMPLATE&quot;</span>
    <span class="s1">TIMEOUT </span><span class="s3">= </span><span class="s4">&quot;TIMEOUT&quot;</span>
    <span class="s1">TAGS </span><span class="s3">= </span><span class="s4">&quot;TAGS&quot;</span>
    <span class="s1">ARGUMENTS </span><span class="s3">= </span><span class="s4">&quot;ARGUMENTS&quot;</span>
    <span class="s1">RETURN </span><span class="s3">= </span><span class="s4">&quot;RETURN&quot;  </span><span class="s0"># TODO: Change to mean RETURN statement in RF 8.</span>
    <span class="s1">RETURN_SETTING </span><span class="s3">= </span><span class="s1">RETURN  </span><span class="s0"># TODO: Remove in RF 8.</span>

    <span class="s1">AS </span><span class="s3">= </span><span class="s4">&quot;AS&quot;</span>
    <span class="s1">WITH_NAME </span><span class="s3">= </span><span class="s1">AS  </span><span class="s0"># TODO: Remove in RF 8.</span>

    <span class="s1">NAME </span><span class="s3">= </span><span class="s4">&quot;NAME&quot;</span>
    <span class="s1">VARIABLE </span><span class="s3">= </span><span class="s4">&quot;VARIABLE&quot;</span>
    <span class="s1">ARGUMENT </span><span class="s3">= </span><span class="s4">&quot;ARGUMENT&quot;</span>
    <span class="s1">ASSIGN </span><span class="s3">= </span><span class="s4">&quot;ASSIGN&quot;</span>
    <span class="s1">KEYWORD </span><span class="s3">= </span><span class="s4">&quot;KEYWORD&quot;</span>
    <span class="s1">FOR </span><span class="s3">= </span><span class="s4">&quot;FOR&quot;</span>
    <span class="s1">FOR_SEPARATOR </span><span class="s3">= </span><span class="s4">&quot;FOR SEPARATOR&quot;</span>
    <span class="s1">END </span><span class="s3">= </span><span class="s4">&quot;END&quot;</span>
    <span class="s1">IF </span><span class="s3">= </span><span class="s4">&quot;IF&quot;</span>
    <span class="s1">INLINE_IF </span><span class="s3">= </span><span class="s4">&quot;INLINE IF&quot;</span>
    <span class="s1">ELSE_IF </span><span class="s3">= </span><span class="s4">&quot;ELSE IF&quot;</span>
    <span class="s1">ELSE </span><span class="s3">= </span><span class="s4">&quot;ELSE&quot;</span>
    <span class="s1">TRY </span><span class="s3">= </span><span class="s4">&quot;TRY&quot;</span>
    <span class="s1">EXCEPT </span><span class="s3">= </span><span class="s4">&quot;EXCEPT&quot;</span>
    <span class="s1">FINALLY </span><span class="s3">= </span><span class="s4">&quot;FINALLY&quot;</span>
    <span class="s1">WHILE </span><span class="s3">= </span><span class="s4">&quot;WHILE&quot;</span>
    <span class="s1">VAR </span><span class="s3">= </span><span class="s4">&quot;VAR&quot;</span>
    <span class="s1">RETURN_STATEMENT </span><span class="s3">= </span><span class="s4">&quot;RETURN STATEMENT&quot;</span>
    <span class="s1">CONTINUE </span><span class="s3">= </span><span class="s4">&quot;CONTINUE&quot;</span>
    <span class="s1">BREAK </span><span class="s3">= </span><span class="s4">&quot;BREAK&quot;</span>
    <span class="s1">OPTION </span><span class="s3">= </span><span class="s4">&quot;OPTION&quot;</span>
    <span class="s1">GROUP </span><span class="s3">= </span><span class="s4">&quot;GROUP&quot;</span>

    <span class="s1">SEPARATOR </span><span class="s3">= </span><span class="s4">&quot;SEPARATOR&quot;</span>
    <span class="s1">COMMENT </span><span class="s3">= </span><span class="s4">&quot;COMMENT&quot;</span>
    <span class="s1">CONTINUATION </span><span class="s3">= </span><span class="s4">&quot;CONTINUATION&quot;</span>
    <span class="s1">CONFIG </span><span class="s3">= </span><span class="s4">&quot;CONFIG&quot;</span>
    <span class="s1">EOL </span><span class="s3">= </span><span class="s4">&quot;EOL&quot;</span>
    <span class="s1">EOS </span><span class="s3">= </span><span class="s4">&quot;EOS&quot;</span>
    <span class="s1">ERROR </span><span class="s3">= </span><span class="s4">&quot;ERROR&quot;</span>
    <span class="s1">FATAL_ERROR </span><span class="s3">= </span><span class="s4">&quot;FATAL ERROR&quot;  </span><span class="s0"># TODO: Remove in RF 8.</span>

    <span class="s1">NON_DATA_TOKENS </span><span class="s3">= {</span>
        <span class="s1">SEPARATOR</span><span class="s3">,</span>
        <span class="s1">COMMENT</span><span class="s3">,</span>
        <span class="s1">CONTINUATION</span><span class="s3">,</span>
        <span class="s1">EOL</span><span class="s3">,</span>
        <span class="s1">EOS</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">SETTING_TOKENS </span><span class="s3">= {</span>
        <span class="s1">DOCUMENTATION</span><span class="s3">,</span>
        <span class="s1">SUITE_NAME</span><span class="s3">,</span>
        <span class="s1">SUITE_SETUP</span><span class="s3">,</span>
        <span class="s1">SUITE_TEARDOWN</span><span class="s3">,</span>
        <span class="s1">METADATA</span><span class="s3">,</span>
        <span class="s1">TEST_SETUP</span><span class="s3">,</span>
        <span class="s1">TEST_TEARDOWN</span><span class="s3">,</span>
        <span class="s1">TEST_TEMPLATE</span><span class="s3">,</span>
        <span class="s1">TEST_TIMEOUT</span><span class="s3">,</span>
        <span class="s1">TEST_TAGS</span><span class="s3">,</span>
        <span class="s1">DEFAULT_TAGS</span><span class="s3">,</span>
        <span class="s1">KEYWORD_TAGS</span><span class="s3">,</span>
        <span class="s1">LIBRARY</span><span class="s3">,</span>
        <span class="s1">RESOURCE</span><span class="s3">,</span>
        <span class="s1">VARIABLES</span><span class="s3">,</span>
        <span class="s1">SETUP</span><span class="s3">,</span>
        <span class="s1">TEARDOWN</span><span class="s3">,</span>
        <span class="s1">TEMPLATE</span><span class="s3">,</span>
        <span class="s1">TIMEOUT</span><span class="s3">,</span>
        <span class="s1">TAGS</span><span class="s3">,</span>
        <span class="s1">ARGUMENTS</span><span class="s3">,</span>
        <span class="s1">RETURN</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">HEADER_TOKENS </span><span class="s3">= {</span>
        <span class="s1">SETTING_HEADER</span><span class="s3">,</span>
        <span class="s1">VARIABLE_HEADER</span><span class="s3">,</span>
        <span class="s1">TESTCASE_HEADER</span><span class="s3">,</span>
        <span class="s1">TASK_HEADER</span><span class="s3">,</span>
        <span class="s1">KEYWORD_HEADER</span><span class="s3">,</span>
        <span class="s1">COMMENT_HEADER</span><span class="s3">,</span>
        <span class="s1">INVALID_HEADER</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">ALLOW_VARIABLES </span><span class="s3">= {</span>
        <span class="s1">NAME</span><span class="s3">,</span>
        <span class="s1">ARGUMENT</span><span class="s3">,</span>
        <span class="s1">TESTCASE_NAME</span><span class="s3">,</span>
        <span class="s1">KEYWORD_NAME</span><span class="s3">,</span>
    <span class="s3">}</span>
    <span class="s1">__slots__ </span><span class="s3">= (</span>
        <span class="s4">&quot;type&quot;</span><span class="s3">,</span>
        <span class="s4">&quot;value&quot;</span><span class="s3">,</span>
        <span class="s4">&quot;lineno&quot;</span><span class="s3">,</span>
        <span class="s4">&quot;col_offset&quot;</span><span class="s3">,</span>
        <span class="s4">&quot;error&quot;</span><span class="s3">,</span>
        <span class="s4">&quot;_add_eos_before&quot;</span><span class="s3">,</span>
        <span class="s4">&quot;_add_eos_after&quot;</span><span class="s3">,</span>
    <span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">type</span><span class="s3">: </span><span class="s4">&quot;str|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">value</span><span class="s3">: </span><span class="s4">&quot;str|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
        <span class="s1">lineno</span><span class="s3">: </span><span class="s1">int </span><span class="s3">= -</span><span class="s6">1</span><span class="s3">,</span>
        <span class="s1">col_offset</span><span class="s3">: </span><span class="s1">int </span><span class="s3">= -</span><span class="s6">1</span><span class="s3">,</span>
        <span class="s1">error</span><span class="s3">: </span><span class="s4">&quot;str|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">type </span><span class="s3">= </span><span class="s1">type</span>
        <span class="s2">if </span><span class="s1">value </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">defaults </span><span class="s3">= {</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">IF</span><span class="s3">: </span><span class="s4">&quot;IF&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">INLINE_IF</span><span class="s3">: </span><span class="s4">&quot;IF&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">ELSE_IF</span><span class="s3">: </span><span class="s4">&quot;ELSE IF&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">ELSE</span><span class="s3">: </span><span class="s4">&quot;ELSE&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">FOR</span><span class="s3">: </span><span class="s4">&quot;FOR&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">WHILE</span><span class="s3">: </span><span class="s4">&quot;WHILE&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">TRY</span><span class="s3">: </span><span class="s4">&quot;TRY&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">EXCEPT</span><span class="s3">: </span><span class="s4">&quot;EXCEPT&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">FINALLY</span><span class="s3">: </span><span class="s4">&quot;FINALLY&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">END</span><span class="s3">: </span><span class="s4">&quot;END&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">VAR</span><span class="s3">: </span><span class="s4">&quot;VAR&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">CONTINUE</span><span class="s3">: </span><span class="s4">&quot;CONTINUE&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">BREAK</span><span class="s3">: </span><span class="s4">&quot;BREAK&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">RETURN_STATEMENT</span><span class="s3">: </span><span class="s4">&quot;RETURN&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">CONTINUATION</span><span class="s3">: </span><span class="s4">&quot;...&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">EOL</span><span class="s3">: </span><span class="s4">&quot;</span><span class="s2">\n</span><span class="s4">&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">WITH_NAME</span><span class="s3">: </span><span class="s4">&quot;AS&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">AS</span><span class="s3">: </span><span class="s4">&quot;AS&quot;</span><span class="s3">,</span>
                <span class="s1">Token</span><span class="s3">.</span><span class="s1">GROUP</span><span class="s3">: </span><span class="s4">&quot;GROUP&quot;</span><span class="s3">,</span>
            <span class="s3">}</span>
            <span class="s1">value </span><span class="s3">= </span><span class="s1">defaults</span><span class="s3">.</span><span class="s1">get</span><span class="s3">(</span><span class="s1">type</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">value </span><span class="s3">= </span><span class="s1">value</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">lineno </span><span class="s3">= </span><span class="s1">lineno</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">col_offset </span><span class="s3">= </span><span class="s1">col_offset</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">error </span><span class="s3">= </span><span class="s1">error</span>
        <span class="s0"># Used internally be lexer to indicate that EOS is needed before/after.</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_add_eos_before </span><span class="s3">= </span><span class="s2">False</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">_add_eos_after </span><span class="s3">= </span><span class="s2">False</span>

    <span class="s3">@</span><span class="s1">property</span>
    <span class="s2">def </span><span class="s1">end_col_offset</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; int</span><span class="s3">:</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">col_offset </span><span class="s3">== -</span><span class="s6">1</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s3">-</span><span class="s6">1</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">col_offset </span><span class="s3">+ </span><span class="s1">len</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">value</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">set_error</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">error</span><span class="s3">: </span><span class="s1">str</span><span class="s3">):</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">type </span><span class="s3">= </span><span class="s1">Token</span><span class="s3">.</span><span class="s1">ERROR</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">error </span><span class="s3">= </span><span class="s1">error</span>

    <span class="s2">def </span><span class="s1">tokenize_variables</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; </span><span class="s4">&quot;Iterator[Token]&quot;</span><span class="s3">:</span>
        <span class="s5">&quot;&quot;&quot;Tokenizes possible variables in token value. 
 
        Yields the token itself if the token does not allow variables (see 
        :attr:`Token.ALLOW_VARIABLES`) or its value does not contain 
        variables. Otherwise, yields variable tokens as well as tokens 
        before, after, or between variables so that they have the same 
        type as the original token. 
        &quot;&quot;&quot;</span>
        <span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">type </span><span class="s2">not in </span><span class="s1">Token</span><span class="s3">.</span><span class="s1">ALLOW_VARIABLES</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_tokenize_no_variables</span><span class="s3">()</span>
        <span class="s1">matches </span><span class="s3">= </span><span class="s1">VariableMatches</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">value</span><span class="s3">)</span>
        <span class="s2">if not </span><span class="s1">matches</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_tokenize_no_variables</span><span class="s3">()</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_tokenize_variables</span><span class="s3">(</span><span class="s1">matches</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_tokenize_no_variables</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; </span><span class="s4">&quot;Iterator[Token]&quot;</span><span class="s3">:</span>
        <span class="s2">yield </span><span class="s1">self</span>

    <span class="s2">def </span><span class="s1">_tokenize_variables</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">matches</span><span class="s3">) </span><span class="s1">-&gt; </span><span class="s4">&quot;Iterator[Token]&quot;</span><span class="s3">:</span>
        <span class="s1">lineno </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">lineno</span>
        <span class="s1">col_offset </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">col_offset</span>
        <span class="s1">after </span><span class="s3">= </span><span class="s4">&quot;&quot;</span>
        <span class="s2">for </span><span class="s1">match </span><span class="s2">in </span><span class="s1">matches</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">match</span><span class="s3">.</span><span class="s1">before</span><span class="s3">:</span>
                <span class="s2">yield </span><span class="s1">Token</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">type</span><span class="s3">, </span><span class="s1">match</span><span class="s3">.</span><span class="s1">before</span><span class="s3">, </span><span class="s1">lineno</span><span class="s3">, </span><span class="s1">col_offset</span><span class="s3">)</span>
            <span class="s2">yield </span><span class="s1">Token</span><span class="s3">(</span><span class="s1">Token</span><span class="s3">.</span><span class="s1">VARIABLE</span><span class="s3">, </span><span class="s1">match</span><span class="s3">.</span><span class="s1">match</span><span class="s3">, </span><span class="s1">lineno</span><span class="s3">, </span><span class="s1">col_offset </span><span class="s3">+ </span><span class="s1">match</span><span class="s3">.</span><span class="s1">start</span><span class="s3">)</span>
            <span class="s1">col_offset </span><span class="s3">+= </span><span class="s1">match</span><span class="s3">.</span><span class="s1">end</span>
            <span class="s1">after </span><span class="s3">= </span><span class="s1">match</span><span class="s3">.</span><span class="s1">after</span>
        <span class="s2">if </span><span class="s1">after</span><span class="s3">:</span>
            <span class="s2">yield </span><span class="s1">Token</span><span class="s3">(</span><span class="s1">self</span><span class="s3">.</span><span class="s1">type</span><span class="s3">, </span><span class="s1">after</span><span class="s3">, </span><span class="s1">lineno</span><span class="s3">, </span><span class="s1">col_offset</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">__str__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; str</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">value</span>

    <span class="s2">def </span><span class="s1">__repr__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">) </span><span class="s1">-&gt; str</span><span class="s3">:</span>
        <span class="s1">typ </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">type</span><span class="s3">.</span><span class="s1">replace</span><span class="s3">(</span><span class="s4">&quot; &quot;</span><span class="s3">, </span><span class="s4">&quot;_&quot;</span><span class="s3">) </span><span class="s2">if </span><span class="s1">self</span><span class="s3">.</span><span class="s1">type </span><span class="s2">else </span><span class="s4">&quot;None&quot;</span>
        <span class="s1">error </span><span class="s3">= </span><span class="s4">&quot;&quot; </span><span class="s2">if not </span><span class="s1">self</span><span class="s3">.</span><span class="s1">error </span><span class="s2">else </span><span class="s4">f&quot;, </span><span class="s2">{</span><span class="s1">self</span><span class="s3">.</span><span class="s1">error</span><span class="s2">!r}</span><span class="s4">&quot;</span>
        <span class="s2">return </span><span class="s4">f&quot;Token(</span><span class="s2">{</span><span class="s1">typ</span><span class="s2">}</span><span class="s4">, </span><span class="s2">{</span><span class="s1">self</span><span class="s3">.</span><span class="s1">value</span><span class="s2">!r}</span><span class="s4">, </span><span class="s2">{</span><span class="s1">self</span><span class="s3">.</span><span class="s1">lineno</span><span class="s2">}</span><span class="s4">, </span><span class="s2">{</span><span class="s1">self</span><span class="s3">.</span><span class="s1">col_offset</span><span class="s2">}{</span><span class="s1">error</span><span class="s2">}</span><span class="s4">)&quot;</span>

    <span class="s2">def </span><span class="s1">__eq__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">other</span><span class="s3">) </span><span class="s1">-&gt; bool</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s3">(</span>
            <span class="s1">isinstance</span><span class="s3">(</span><span class="s1">other</span><span class="s3">, </span><span class="s1">Token</span><span class="s3">)</span>
            <span class="s2">and </span><span class="s1">self</span><span class="s3">.</span><span class="s1">type </span><span class="s3">== </span><span class="s1">other</span><span class="s3">.</span><span class="s1">type</span>
            <span class="s2">and </span><span class="s1">self</span><span class="s3">.</span><span class="s1">value </span><span class="s3">== </span><span class="s1">other</span><span class="s3">.</span><span class="s1">value</span>
            <span class="s2">and </span><span class="s1">self</span><span class="s3">.</span><span class="s1">lineno </span><span class="s3">== </span><span class="s1">other</span><span class="s3">.</span><span class="s1">lineno</span>
            <span class="s2">and </span><span class="s1">self</span><span class="s3">.</span><span class="s1">col_offset </span><span class="s3">== </span><span class="s1">other</span><span class="s3">.</span><span class="s1">col_offset</span>
            <span class="s2">and </span><span class="s1">self</span><span class="s3">.</span><span class="s1">error </span><span class="s3">== </span><span class="s1">other</span><span class="s3">.</span><span class="s1">error</span>
        <span class="s3">)</span>


<span class="s2">class </span><span class="s1">EOS</span><span class="s3">(</span><span class="s1">Token</span><span class="s3">):</span>
    <span class="s5">&quot;&quot;&quot;Token representing end of a statement.&quot;&quot;&quot;</span>

    <span class="s1">__slots__ </span><span class="s3">= ()</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">lineno</span><span class="s3">: </span><span class="s1">int </span><span class="s3">= -</span><span class="s6">1</span><span class="s3">, </span><span class="s1">col_offset</span><span class="s3">: </span><span class="s1">int </span><span class="s3">= -</span><span class="s6">1</span><span class="s3">):</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">Token</span><span class="s3">.</span><span class="s1">EOS</span><span class="s3">, </span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s1">lineno</span><span class="s3">, </span><span class="s1">col_offset</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_token</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">token</span><span class="s3">: </span><span class="s1">Token</span><span class="s3">, </span><span class="s1">before</span><span class="s3">: </span><span class="s1">bool </span><span class="s3">= </span><span class="s2">False</span><span class="s3">) </span><span class="s1">-&gt; </span><span class="s4">&quot;EOS&quot;</span><span class="s3">:</span>
        <span class="s1">col_offset </span><span class="s3">= </span><span class="s1">token</span><span class="s3">.</span><span class="s1">col_offset </span><span class="s2">if </span><span class="s1">before </span><span class="s2">else </span><span class="s1">token</span><span class="s3">.</span><span class="s1">end_col_offset</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span><span class="s1">token</span><span class="s3">.</span><span class="s1">lineno</span><span class="s3">, </span><span class="s1">col_offset</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">END</span><span class="s3">(</span><span class="s1">Token</span><span class="s3">):</span>
    <span class="s5">&quot;&quot;&quot;Token representing END token used to signify block ending. 
 
    Virtual END tokens have '' as their value, with &quot;real&quot; END tokens the 
    value is 'END'. 
    &quot;&quot;&quot;</span>

    <span class="s1">__slots__ </span><span class="s3">= ()</span>

    <span class="s2">def </span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">lineno</span><span class="s3">: </span><span class="s1">int </span><span class="s3">= -</span><span class="s6">1</span><span class="s3">, </span><span class="s1">col_offset</span><span class="s3">: </span><span class="s1">int </span><span class="s3">= -</span><span class="s6">1</span><span class="s3">, </span><span class="s1">virtual</span><span class="s3">: </span><span class="s1">bool </span><span class="s3">= </span><span class="s2">False</span><span class="s3">):</span>
        <span class="s1">value </span><span class="s3">= </span><span class="s4">&quot;END&quot; </span><span class="s2">if not </span><span class="s1">virtual </span><span class="s2">else </span><span class="s4">&quot;&quot;</span>
        <span class="s1">super</span><span class="s3">().</span><span class="s1">__init__</span><span class="s3">(</span><span class="s1">Token</span><span class="s3">.</span><span class="s1">END</span><span class="s3">, </span><span class="s1">value</span><span class="s3">, </span><span class="s1">lineno</span><span class="s3">, </span><span class="s1">col_offset</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">classmethod</span>
    <span class="s2">def </span><span class="s1">from_token</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">, </span><span class="s1">token</span><span class="s3">: </span><span class="s1">Token</span><span class="s3">, </span><span class="s1">virtual</span><span class="s3">: </span><span class="s1">bool </span><span class="s3">= </span><span class="s2">False</span><span class="s3">) </span><span class="s1">-&gt; </span><span class="s4">&quot;END&quot;</span><span class="s3">:</span>
        <span class="s2">return </span><span class="s1">cls</span><span class="s3">(</span><span class="s1">token</span><span class="s3">.</span><span class="s1">lineno</span><span class="s3">, </span><span class="s1">token</span><span class="s3">.</span><span class="s1">end_col_offset</span><span class="s3">, </span><span class="s1">virtual</span><span class="s3">)</span>
</pre>
</body>
</html>