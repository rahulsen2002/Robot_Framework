<html>
<head>
<title>deco.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #5f826b; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
deco.py</font>
</center></td></tr></table>
<pre><span class="s0">#  Copyright 2008-2015 Nokia Networks</span>
<span class="s0">#  Copyright 2016-     Robot Framework Foundation</span>
<span class="s0">#</span>
<span class="s0">#  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="s0">#  you may not use this file except in compliance with the License.</span>
<span class="s0">#  You may obtain a copy of the License at</span>
<span class="s0">#</span>
<span class="s0">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="s0">#</span>
<span class="s0">#  Unless required by applicable law or agreed to in writing, software</span>
<span class="s0">#  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="s0">#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="s0">#  See the License for the specific language governing permissions and</span>
<span class="s0">#  limitations under the License.</span>

<span class="s2">from </span><span class="s1">typing </span><span class="s2">import </span><span class="s1">Any</span><span class="s3">, </span><span class="s1">Callable</span><span class="s3">, </span><span class="s1">Literal</span><span class="s3">, </span><span class="s1">overload</span><span class="s3">, </span><span class="s1">Sequence</span><span class="s3">, </span><span class="s1">TypeVar</span><span class="s3">, </span><span class="s1">Union</span>

<span class="s2">from </span><span class="s3">.</span><span class="s1">interfaces </span><span class="s2">import </span><span class="s1">TypeHints</span>

<span class="s1">F </span><span class="s3">= </span><span class="s1">TypeVar</span><span class="s3">(</span><span class="s4">&quot;F&quot;</span><span class="s3">, </span><span class="s1">bound</span><span class="s3">=</span><span class="s1">Callable</span><span class="s3">[..., </span><span class="s1">Any</span><span class="s3">])</span>
<span class="s1">K </span><span class="s3">= </span><span class="s1">TypeVar</span><span class="s3">(</span><span class="s4">&quot;K&quot;</span><span class="s3">, </span><span class="s1">bound</span><span class="s3">=</span><span class="s1">Callable</span><span class="s3">[..., </span><span class="s1">Any</span><span class="s3">])</span>
<span class="s1">L </span><span class="s3">= </span><span class="s1">TypeVar</span><span class="s3">(</span><span class="s4">&quot;L&quot;</span><span class="s3">, </span><span class="s1">bound</span><span class="s3">=</span><span class="s1">type</span><span class="s3">)</span>
<span class="s1">KeywordDecorator </span><span class="s3">= </span><span class="s1">Callable</span><span class="s3">[[</span><span class="s1">K</span><span class="s3">], </span><span class="s1">K</span><span class="s3">]</span>
<span class="s1">LibraryDecorator </span><span class="s3">= </span><span class="s1">Callable</span><span class="s3">[[</span><span class="s1">L</span><span class="s3">], </span><span class="s1">L</span><span class="s3">]</span>
<span class="s1">Scope </span><span class="s3">= </span><span class="s1">Literal</span><span class="s3">[</span><span class="s4">&quot;GLOBAL&quot;</span><span class="s3">, </span><span class="s4">&quot;SUITE&quot;</span><span class="s3">, </span><span class="s4">&quot;TEST&quot;</span><span class="s3">, </span><span class="s4">&quot;TASK&quot;</span><span class="s3">]</span>
<span class="s1">Converter </span><span class="s3">= </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">Callable</span><span class="s3">[[</span><span class="s1">Any</span><span class="s3">], </span><span class="s1">Any</span><span class="s3">], </span><span class="s1">Callable</span><span class="s3">[[</span><span class="s1">Any</span><span class="s3">, </span><span class="s1">Any</span><span class="s3">], </span><span class="s1">Any</span><span class="s3">]]</span>
<span class="s1">DocFormat </span><span class="s3">= </span><span class="s1">Literal</span><span class="s3">[</span><span class="s4">&quot;ROBOT&quot;</span><span class="s3">, </span><span class="s4">&quot;HTML&quot;</span><span class="s3">, </span><span class="s4">&quot;TEXT&quot;</span><span class="s3">, </span><span class="s4">&quot;REST&quot;</span><span class="s3">]</span>


<span class="s2">def </span><span class="s1">not_keyword</span><span class="s3">(</span><span class="s1">func</span><span class="s3">: </span><span class="s1">F</span><span class="s3">) </span><span class="s1">-&gt; F</span><span class="s3">:</span>
    <span class="s5">&quot;&quot;&quot;Decorator to disable exposing functions or methods as keywords. 
 
    Examples:: 
 
        @not_keyword 
        def not_exposed_as_keyword(): 
            # ... 
 
        def exposed_as_keyword(): 
            # ... 
 
    Alternatively the automatic keyword discovery can be disabled with 
    the :func:`library` decorator or by setting the ``ROBOT_AUTO_KEYWORDS`` 
    attribute to a false value. 
 
    New in Robot Framework 3.2. 
    &quot;&quot;&quot;</span>
    <span class="s1">func</span><span class="s3">.</span><span class="s1">robot_not_keyword </span><span class="s3">= </span><span class="s2">True</span>
    <span class="s2">return </span><span class="s1">func</span>


<span class="s1">not_keyword</span><span class="s3">.</span><span class="s1">robot_not_keyword </span><span class="s3">= </span><span class="s2">True</span>


<span class="s3">@</span><span class="s1">overload</span>
<span class="s2">def </span><span class="s1">keyword</span><span class="s3">(</span><span class="s1">func</span><span class="s3">: </span><span class="s1">K</span><span class="s3">, /) </span><span class="s1">-&gt; K</span><span class="s3">: ...</span>


<span class="s3">@</span><span class="s1">overload</span>
<span class="s2">def </span><span class="s1">keyword</span><span class="s3">(</span>
    <span class="s1">name</span><span class="s3">: </span><span class="s4">&quot;str|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">tags</span><span class="s3">: </span><span class="s1">Sequence</span><span class="s3">[</span><span class="s1">str</span><span class="s3">] = (),</span>
    <span class="s1">types</span><span class="s3">: </span><span class="s4">&quot;TypeHints|None&quot; </span><span class="s3">= (),</span>
<span class="s3">) </span><span class="s1">-&gt; KeywordDecorator</span><span class="s3">: ...</span>


<span class="s3">@</span><span class="s1">not_keyword</span>
<span class="s2">def </span><span class="s1">keyword</span><span class="s3">(</span>
    <span class="s1">name</span><span class="s3">: </span><span class="s4">&quot;K|str|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">tags</span><span class="s3">: </span><span class="s1">Sequence</span><span class="s3">[</span><span class="s1">str</span><span class="s3">] = (),</span>
    <span class="s1">types</span><span class="s3">: </span><span class="s4">&quot;TypeHints|None&quot; </span><span class="s3">= (),</span>
<span class="s3">) </span><span class="s1">-&gt; </span><span class="s4">&quot;K|KeywordDecorator&quot;</span><span class="s3">:</span>
    <span class="s5">&quot;&quot;&quot;Decorator to set custom name, tags and argument types to keywords. 
 
    This decorator creates ``robot_name``, ``robot_tags`` and ``robot_types`` 
    attributes on the decorated keyword function or method based on the 
    provided arguments. Robot Framework checks them to determine the keyword's 
    name, tags, and argument types, respectively. 
 
    Name must be given as a string, tags as a list of strings, and types 
    either as a dictionary mapping argument names to types or as a list 
    of types mapped to arguments based on position. It is OK to specify types 
    only to some arguments, and setting ``types`` to ``None`` disables type 
    conversion altogether. 
 
    If the automatic keyword discovery has been disabled with the 
    :func:`library` decorator or by setting the ``ROBOT_AUTO_KEYWORDS`` 
    attribute to a false value, this decorator is needed to mark functions 
    or methods keywords. 
 
    Examples:: 
 
        @keyword 
        def example(): 
            # ... 
 
        @keyword('Login as user &quot;${user}&quot; with password &quot;${password}&quot;', 
                 tags=['custom name', 'embedded arguments', 'tags']) 
        def login(user, password): 
            # ... 
 
        @keyword(types={'length': int, 'case_insensitive': bool}) 
        def types_as_dict(length, case_insensitive): 
            # ... 
 
        @keyword(types=[int, bool]) 
        def types_as_list(length, case_insensitive): 
            # ... 
 
        @keyword(types=None) 
        def no_conversion(length, case_insensitive=False): 
            # ... 
    &quot;&quot;&quot;</span>
    <span class="s2">if </span><span class="s1">callable</span><span class="s3">(</span><span class="s1">name</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">keyword</span><span class="s3">()(</span><span class="s1">name</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">decorator</span><span class="s3">(</span><span class="s1">func</span><span class="s3">: </span><span class="s1">F</span><span class="s3">) </span><span class="s1">-&gt; F</span><span class="s3">:</span>
        <span class="s1">func</span><span class="s3">.</span><span class="s1">robot_name </span><span class="s3">= </span><span class="s1">name</span>
        <span class="s1">func</span><span class="s3">.</span><span class="s1">robot_tags </span><span class="s3">= </span><span class="s1">tags</span>
        <span class="s1">func</span><span class="s3">.</span><span class="s1">robot_types </span><span class="s3">= </span><span class="s1">types</span>
        <span class="s2">return </span><span class="s1">func</span>

    <span class="s2">return </span><span class="s1">decorator</span>


<span class="s3">@</span><span class="s1">overload</span>
<span class="s2">def </span><span class="s1">library</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">: </span><span class="s1">L</span><span class="s3">, /) </span><span class="s1">-&gt; L</span><span class="s3">: ...</span>


<span class="s3">@</span><span class="s1">overload</span>
<span class="s2">def </span><span class="s1">library</span><span class="s3">(</span>
    <span class="s1">scope</span><span class="s3">: </span><span class="s4">&quot;Scope|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">version</span><span class="s3">: </span><span class="s4">&quot;str|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">converters</span><span class="s3">: </span><span class="s4">&quot;dict[type, Converter]|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">doc_format</span><span class="s3">: </span><span class="s4">&quot;DocFormat|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">listener</span><span class="s3">: </span><span class="s4">&quot;Any|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">auto_keywords</span><span class="s3">: </span><span class="s1">bool </span><span class="s3">= </span><span class="s2">False</span><span class="s3">,</span>
<span class="s3">) </span><span class="s1">-&gt; LibraryDecorator</span><span class="s3">: ...</span>


<span class="s3">@</span><span class="s1">not_keyword</span>
<span class="s2">def </span><span class="s1">library</span><span class="s3">(</span>
    <span class="s1">scope</span><span class="s3">: </span><span class="s4">&quot;L|Scope|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">version</span><span class="s3">: </span><span class="s4">&quot;str|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">converters</span><span class="s3">: </span><span class="s4">&quot;dict[type, Converter]|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">doc_format</span><span class="s3">: </span><span class="s4">&quot;DocFormat|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">listener</span><span class="s3">: </span><span class="s4">&quot;Any|None&quot; </span><span class="s3">= </span><span class="s2">None</span><span class="s3">,</span>
    <span class="s1">auto_keywords</span><span class="s3">: </span><span class="s1">bool </span><span class="s3">= </span><span class="s2">False</span><span class="s3">,</span>
<span class="s3">) </span><span class="s1">-&gt; </span><span class="s4">&quot;L|LibraryDecorator&quot;</span><span class="s3">:</span>
    <span class="s5">&quot;&quot;&quot;Class decorator to control keyword discovery and other library settings. 
 
    Disables automatic keyword detection by setting class attribute 
    ``ROBOT_AUTO_KEYWORDS = False`` to the decorated library by default. In that 
    mode only methods decorated explicitly with the :func:`keyword` decorator 
    become keywords. If that is not desired, automatic keyword discovery can be 
    enabled by using ``auto_keywords=True``. 
 
    Arguments ``scope``, ``version``, ``converters``, ``doc_format`` and ``listener`` 
    set library's scope, version, converters, documentation format and listener by 
    using class attributes ``ROBOT_LIBRARY_SCOPE``, ``ROBOT_LIBRARY_VERSION``, 
    ``ROBOT_LIBRARY_CONVERTERS``, ``ROBOT_LIBRARY_DOC_FORMAT`` and 
    ``ROBOT_LIBRARY_LISTENER``, respectively. These attributes are only set if 
    the related arguments are given, and they override possible existing attributes 
    in the decorated class. 
 
    Examples:: 
 
        @library 
        class KeywordDiscovery: 
 
            @keyword 
            def do_something(self): 
                # ... 
 
            def not_keyword(self): 
                # ... 
 
 
        @library(scope='GLOBAL', version='3.2') 
        class LibraryConfiguration: 
            # ... 
 
    The ``@library`` decorator is new in Robot Framework 3.2. 
    The ``converters`` argument is new in Robot Framework 5.0. 
    &quot;&quot;&quot;</span>
    <span class="s2">if </span><span class="s1">isinstance</span><span class="s3">(</span><span class="s1">scope</span><span class="s3">, </span><span class="s1">type</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">library</span><span class="s3">()(</span><span class="s1">scope</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">decorator</span><span class="s3">(</span><span class="s1">cls</span><span class="s3">: </span><span class="s1">L</span><span class="s3">) </span><span class="s1">-&gt; L</span><span class="s3">:</span>
        <span class="s2">if </span><span class="s1">scope </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">cls</span><span class="s3">.</span><span class="s1">ROBOT_LIBRARY_SCOPE </span><span class="s3">= </span><span class="s1">scope</span>
        <span class="s2">if </span><span class="s1">version </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">cls</span><span class="s3">.</span><span class="s1">ROBOT_LIBRARY_VERSION </span><span class="s3">= </span><span class="s1">version</span>
        <span class="s2">if </span><span class="s1">converters </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">cls</span><span class="s3">.</span><span class="s1">ROBOT_LIBRARY_CONVERTERS </span><span class="s3">= </span><span class="s1">converters</span>
        <span class="s2">if </span><span class="s1">doc_format </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">cls</span><span class="s3">.</span><span class="s1">ROBOT_LIBRARY_DOC_FORMAT </span><span class="s3">= </span><span class="s1">doc_format</span>
        <span class="s2">if </span><span class="s1">listener </span><span class="s2">is not None</span><span class="s3">:</span>
            <span class="s1">cls</span><span class="s3">.</span><span class="s1">ROBOT_LIBRARY_LISTENER </span><span class="s3">= </span><span class="s1">listener</span>
        <span class="s1">cls</span><span class="s3">.</span><span class="s1">ROBOT_AUTO_KEYWORDS </span><span class="s3">= </span><span class="s1">auto_keywords</span>
        <span class="s2">return </span><span class="s1">cls</span>

    <span class="s2">return </span><span class="s1">decorator</span>
</pre>
</body>
</html>