<html>
<head>
<title>runonfailure.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #5f826b; font-style: italic;}
.s5 { color: #6aab73;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
runonfailure.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright 2008-2011 Nokia Networks</span>
<span class="s0"># Copyright 2011-2016 Ryan Tomac, Ed Manlove and contributors</span>
<span class="s0"># Copyright 2016-     Robot Framework Foundation</span>
<span class="s0">#</span>
<span class="s0"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="s0"># you may not use this file except in compliance with the License.</span>
<span class="s0"># You may obtain a copy of the License at</span>
<span class="s0">#</span>
<span class="s0">#    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="s0">#</span>
<span class="s0"># Unless required by applicable law or agreed to in writing, software</span>
<span class="s0"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="s0"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="s0"># See the License for the specific language governing permissions and</span>
<span class="s0"># limitations under the License.</span>
<span class="s2">from </span><span class="s1">typing </span><span class="s2">import </span><span class="s1">Optional</span>

<span class="s2">from </span><span class="s1">SeleniumLibrary</span><span class="s3">.</span><span class="s1">base </span><span class="s2">import </span><span class="s1">LibraryComponent</span><span class="s3">, </span><span class="s1">keyword</span>


<span class="s2">class </span><span class="s1">RunOnFailureKeywords</span><span class="s3">(</span><span class="s1">LibraryComponent</span><span class="s3">):</span>
    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">register_keyword_to_run_on_failure</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">keyword</span><span class="s3">: </span><span class="s1">Optional</span><span class="s3">[</span><span class="s1">str</span><span class="s3">]) </span><span class="s1">-&gt; str</span><span class="s3">:</span>
        <span class="s4">&quot;&quot;&quot;Sets the keyword to execute, when a SeleniumLibrary keyword fails. 
 
        ``keyword`` is the name of a keyword that will be executed if a 
        SeleniumLibrary keyword fails. It is possible to use any available 
        keyword, including user keywords or keywords from other libraries, 
        but the keyword must not take any arguments. 
 
        The initial keyword to use is set when `importing` the library, and 
        the keyword that is used by default is `Capture Page Screenshot`. 
        Taking a screenshot when something failed is a very useful 
        feature, but notice that it can slow down the execution. 
 
        It is possible to use string ``NOTHING`` or ``NONE``, 
        case-insensitively, as well as Python ``None`` to disable this 
        feature altogether. 
 
        This keyword returns the name of the previously registered 
        failure keyword or Python ``None`` if this functionality was 
        previously disabled. The return value can be always used to 
        restore the original value later. 
 
        Example: 
        | `Register Keyword To Run On Failure`  | Log Source | 
        | ${previous kw}= | `Register Keyword To Run On Failure`  | NONE | 
        | `Register Keyword To Run On Failure`  | ${previous kw} | 
 
        Changes in SeleniumLibrary 3.0: 
        - Possible to use string ``NONE`` or Python ``None`` to disable the 
          functionality. 
        - Return Python ``None`` when the functionality was disabled earlier. 
          In previous versions special value ``No Keyword`` was returned and 
          it could not be used to restore the original state. 
        &quot;&quot;&quot;</span>
        <span class="s1">old_keyword </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">ctx</span><span class="s3">.</span><span class="s1">run_on_failure_keyword</span>
        <span class="s1">new_keyword </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">resolve_keyword</span><span class="s3">(</span><span class="s1">keyword</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">ctx</span><span class="s3">.</span><span class="s1">run_on_failure_keyword </span><span class="s3">= </span><span class="s1">new_keyword</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">info</span><span class="s3">(</span><span class="s5">f&quot;</span><span class="s2">{</span><span class="s3">(</span><span class="s1">new_keyword </span><span class="s2">or </span><span class="s5">'No keyword'</span><span class="s3">)</span><span class="s2">} </span><span class="s5">will be run on failure.&quot;</span><span class="s3">)</span>
        <span class="s2">return </span><span class="s1">old_keyword</span>

    <span class="s3">@</span><span class="s1">staticmethod</span>
    <span class="s2">def </span><span class="s1">resolve_keyword</span><span class="s3">(</span><span class="s1">name</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">name </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s2">return None</span>
        <span class="s2">if </span><span class="s3">(</span>
            <span class="s1">isinstance</span><span class="s3">(</span><span class="s1">name</span><span class="s3">, </span><span class="s1">str</span><span class="s3">)</span>
            <span class="s2">and </span><span class="s1">name</span><span class="s3">.</span><span class="s1">upper</span><span class="s3">() == </span><span class="s5">&quot;NOTHING&quot;</span>
            <span class="s2">or </span><span class="s1">name</span><span class="s3">.</span><span class="s1">upper</span><span class="s3">() == </span><span class="s5">&quot;NONE&quot;</span>
        <span class="s3">):</span>
            <span class="s2">return None</span>
        <span class="s2">return </span><span class="s1">name</span>
</pre>
</body>
</html>