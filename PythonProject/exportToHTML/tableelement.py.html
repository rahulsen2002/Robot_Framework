<html>
<head>
<title>tableelement.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #5f826b; font-style: italic;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
tableelement.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright 2008-2011 Nokia Networks</span>
<span class="s0"># Copyright 2011-2016 Ryan Tomac, Ed Manlove and contributors</span>
<span class="s0"># Copyright 2016-     Robot Framework Foundation</span>
<span class="s0">#</span>
<span class="s0"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="s0"># you may not use this file except in compliance with the License.</span>
<span class="s0"># You may obtain a copy of the License at</span>
<span class="s0">#</span>
<span class="s0">#    http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="s0">#</span>
<span class="s0"># Unless required by applicable law or agreed to in writing, software</span>
<span class="s0"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="s0"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="s0"># See the License for the specific language governing permissions and</span>
<span class="s0"># limitations under the License.</span>
<span class="s2">from </span><span class="s1">typing </span><span class="s2">import </span><span class="s1">Union</span>

<span class="s2">from </span><span class="s1">selenium</span><span class="s3">.</span><span class="s1">webdriver</span><span class="s3">.</span><span class="s1">common</span><span class="s3">.</span><span class="s1">by </span><span class="s2">import </span><span class="s1">By</span>
<span class="s2">from </span><span class="s1">selenium</span><span class="s3">.</span><span class="s1">webdriver</span><span class="s3">.</span><span class="s1">remote</span><span class="s3">.</span><span class="s1">webelement </span><span class="s2">import </span><span class="s1">WebElement</span>

<span class="s2">from </span><span class="s1">SeleniumLibrary</span><span class="s3">.</span><span class="s1">base </span><span class="s2">import </span><span class="s1">LibraryComponent</span><span class="s3">, </span><span class="s1">keyword</span>


<span class="s2">class </span><span class="s1">TableElementKeywords</span><span class="s3">(</span><span class="s1">LibraryComponent</span><span class="s3">):</span>
    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">get_table_cell</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">locator</span><span class="s3">: </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">WebElement</span><span class="s3">, </span><span class="s1">str</span><span class="s3">],</span>
        <span class="s1">row</span><span class="s3">: </span><span class="s1">int</span><span class="s3">,</span>
        <span class="s1">column</span><span class="s3">: </span><span class="s1">int</span><span class="s3">,</span>
        <span class="s1">loglevel</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;TRACE&quot;</span><span class="s3">,</span>
    <span class="s3">) </span><span class="s1">-&gt; str</span><span class="s3">:</span>
        <span class="s5">&quot;&quot;&quot;Returns contents of a table cell. 
 
        The table is located using the ``locator`` argument and its cell 
        found using ``row`` and ``column``. See the `Locating elements` 
        section for details about the locator syntax. 
 
        Both row and column indexes start from 1, and header and footer 
        rows are included in the count. It is possible to refer to rows 
        and columns from the end by using negative indexes so that -1 
        is the last row/column, -2 is the second last, and so on. 
 
        All ``&lt;th&gt;`` and ``&lt;td&gt;`` elements anywhere in the table are 
        considered to be cells. 
 
        See `Page Should Contain` for an explanation about the ``loglevel`` 
        argument. 
        &quot;&quot;&quot;</span>
        <span class="s2">if </span><span class="s1">row </span><span class="s3">== </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">column </span><span class="s3">== </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s2">raise </span><span class="s1">ValueError</span><span class="s3">(</span>
                <span class="s4">&quot;Both row and column must be non-zero, &quot;</span>
                <span class="s4">f&quot;got row </span><span class="s2">{</span><span class="s1">row</span><span class="s2">} </span><span class="s4">and column </span><span class="s2">{</span><span class="s1">column</span><span class="s2">}</span><span class="s4">.&quot;</span>
            <span class="s3">)</span>
        <span class="s2">try</span><span class="s3">:</span>
            <span class="s1">cell </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_get_cell</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">row</span><span class="s3">, </span><span class="s1">column</span><span class="s3">)</span>
        <span class="s2">except </span><span class="s1">AssertionError</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">log_source</span><span class="s3">(</span><span class="s1">loglevel</span><span class="s3">)</span>
            <span class="s2">raise</span>
        <span class="s2">return </span><span class="s1">cell</span><span class="s3">.</span><span class="s1">text</span>

    <span class="s2">def </span><span class="s1">_get_cell</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">locator</span><span class="s3">, </span><span class="s1">row</span><span class="s3">, </span><span class="s1">column</span><span class="s3">):</span>
        <span class="s1">rows </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_get_rows</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">row</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">rows</span><span class="s3">) &lt; </span><span class="s1">abs</span><span class="s3">(</span><span class="s1">row</span><span class="s3">):</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span>
                <span class="s4">f&quot;Table '</span><span class="s2">{</span><span class="s1">locator</span><span class="s2">}</span><span class="s4">' should have had at least </span><span class="s2">{</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">row</span><span class="s3">)</span><span class="s2">} </span><span class="s4">&quot;</span>
                <span class="s4">f&quot;rows but had only </span><span class="s2">{</span><span class="s1">len</span><span class="s3">(</span><span class="s1">rows</span><span class="s3">)</span><span class="s2">}</span><span class="s4">.&quot;</span>
            <span class="s3">)</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">row </span><span class="s3">- </span><span class="s6">1 </span><span class="s2">if </span><span class="s1">row </span><span class="s3">&gt; </span><span class="s6">0 </span><span class="s2">else </span><span class="s1">row</span>
        <span class="s1">cells </span><span class="s3">= </span><span class="s1">rows</span><span class="s3">[</span><span class="s1">index</span><span class="s3">].</span><span class="s1">find_elements</span><span class="s3">(</span><span class="s1">By</span><span class="s3">.</span><span class="s1">XPATH</span><span class="s3">, </span><span class="s4">&quot;./th|./td&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">len</span><span class="s3">(</span><span class="s1">cells</span><span class="s3">) &lt; </span><span class="s1">abs</span><span class="s3">(</span><span class="s1">column</span><span class="s3">):</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span>
                <span class="s4">f&quot;Table '</span><span class="s2">{</span><span class="s1">locator</span><span class="s2">}</span><span class="s4">' row </span><span class="s2">{</span><span class="s1">row</span><span class="s2">} </span><span class="s4">should have had at &quot;</span>
                <span class="s4">f&quot;least </span><span class="s2">{</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">column</span><span class="s3">)</span><span class="s2">} </span><span class="s4">columns but had only </span><span class="s2">{</span><span class="s1">len</span><span class="s3">(</span><span class="s1">cells</span><span class="s3">)</span><span class="s2">}</span><span class="s4">.&quot;</span>
            <span class="s3">)</span>
        <span class="s1">index </span><span class="s3">= </span><span class="s1">column </span><span class="s3">- </span><span class="s6">1 </span><span class="s2">if </span><span class="s1">column </span><span class="s3">&gt; </span><span class="s6">0 </span><span class="s2">else </span><span class="s1">column</span>
        <span class="s2">return </span><span class="s1">cells</span><span class="s3">[</span><span class="s1">index</span><span class="s3">]</span>

    <span class="s2">def </span><span class="s1">_get_rows</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">locator</span><span class="s3">, </span><span class="s1">count</span><span class="s3">):</span>
        <span class="s0"># Get rows in same order as browsers render them.</span>
        <span class="s1">table </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">find_element</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">tag</span><span class="s3">=</span><span class="s4">&quot;table&quot;</span><span class="s3">)</span>
        <span class="s1">rows </span><span class="s3">= </span><span class="s1">table</span><span class="s3">.</span><span class="s1">find_elements</span><span class="s3">(</span><span class="s1">By</span><span class="s3">.</span><span class="s1">XPATH</span><span class="s3">, </span><span class="s4">&quot;./thead/tr&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">count </span><span class="s3">&lt; </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">len</span><span class="s3">(</span><span class="s1">rows</span><span class="s3">) &lt; </span><span class="s1">count</span><span class="s3">:</span>
            <span class="s1">rows</span><span class="s3">.</span><span class="s1">extend</span><span class="s3">(</span><span class="s1">table</span><span class="s3">.</span><span class="s1">find_elements</span><span class="s3">(</span><span class="s1">By</span><span class="s3">.</span><span class="s1">XPATH</span><span class="s3">, </span><span class="s4">&quot;./tbody/tr&quot;</span><span class="s3">))</span>
        <span class="s2">if </span><span class="s1">count </span><span class="s3">&lt; </span><span class="s6">0 </span><span class="s2">or </span><span class="s1">len</span><span class="s3">(</span><span class="s1">rows</span><span class="s3">) &lt; </span><span class="s1">count</span><span class="s3">:</span>
            <span class="s1">rows</span><span class="s3">.</span><span class="s1">extend</span><span class="s3">(</span><span class="s1">table</span><span class="s3">.</span><span class="s1">find_elements</span><span class="s3">(</span><span class="s1">By</span><span class="s3">.</span><span class="s1">XPATH</span><span class="s3">, </span><span class="s4">&quot;./tfoot/tr&quot;</span><span class="s3">))</span>
        <span class="s2">return </span><span class="s1">rows</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">table_cell_should_contain</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">locator</span><span class="s3">: </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">WebElement</span><span class="s3">, </span><span class="s1">str</span><span class="s3">],</span>
        <span class="s1">row</span><span class="s3">: </span><span class="s1">int</span><span class="s3">,</span>
        <span class="s1">column</span><span class="s3">: </span><span class="s1">int</span><span class="s3">,</span>
        <span class="s1">expected</span><span class="s3">: </span><span class="s1">str</span><span class="s3">,</span>
        <span class="s1">loglevel</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;TRACE&quot;</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Verifies table cell contains text ``expected``. 
 
        See `Get Table Cell` that this keyword uses internally for 
        an explanation about accepted arguments. 
        &quot;&quot;&quot;</span>
        <span class="s1">content </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">get_table_cell</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">row</span><span class="s3">, </span><span class="s1">column</span><span class="s3">, </span><span class="s1">loglevel</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">expected </span><span class="s2">not in </span><span class="s1">content</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">ctx</span><span class="s3">.</span><span class="s1">log_source</span><span class="s3">(</span><span class="s1">loglevel</span><span class="s3">)</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span>
                <span class="s4">f&quot;Table '</span><span class="s2">{</span><span class="s1">locator</span><span class="s2">}</span><span class="s4">' cell on row </span><span class="s2">{</span><span class="s1">row</span><span class="s2">} </span><span class="s4">and column </span><span class="s2">{</span><span class="s1">column</span><span class="s2">} </span><span class="s4">&quot;</span>
                <span class="s4">f&quot;should have contained text '</span><span class="s2">{</span><span class="s1">expected</span><span class="s2">}</span><span class="s4">' but it had '</span><span class="s2">{</span><span class="s1">content</span><span class="s2">}</span><span class="s4">'.&quot;</span>
            <span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">info</span><span class="s3">(</span><span class="s4">f&quot;Table cell contains '</span><span class="s2">{</span><span class="s1">content</span><span class="s2">}</span><span class="s4">'.&quot;</span><span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">table_column_should_contain</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">locator</span><span class="s3">: </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">WebElement</span><span class="s3">, </span><span class="s1">str</span><span class="s3">],</span>
        <span class="s1">column</span><span class="s3">: </span><span class="s1">int</span><span class="s3">,</span>
        <span class="s1">expected</span><span class="s3">: </span><span class="s1">str</span><span class="s3">,</span>
        <span class="s1">loglevel</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;TRACE&quot;</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Verifies table column contains text ``expected``. 
 
        The table is located using the ``locator`` argument and its column 
        found using ``column``. See the `Locating elements` section for 
        details about the locator syntax. 
 
        Column indexes start from 1. It is possible to refer to columns 
        from the end by using negative indexes so that -1 is the last column, 
        -2 is the second last, and so on. 
 
        If a table contains cells that span multiple columns, those merged 
        cells count as a single column. 
 
        See `Page Should Contain Element` for an explanation about the 
        ``loglevel`` argument. 
        &quot;&quot;&quot;</span>
        <span class="s1">element </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find_by_column</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">column</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">element </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">ctx</span><span class="s3">.</span><span class="s1">log_source</span><span class="s3">(</span><span class="s1">loglevel</span><span class="s3">)</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span>
                <span class="s4">f&quot;Table '</span><span class="s2">{</span><span class="s1">locator</span><span class="s2">}</span><span class="s4">' column </span><span class="s2">{</span><span class="s1">column</span><span class="s2">} </span><span class="s4">did not contain text '</span><span class="s2">{</span><span class="s1">expected</span><span class="s2">}</span><span class="s4">'.&quot;</span>
            <span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">table_footer_should_contain</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">locator</span><span class="s3">: </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">WebElement</span><span class="s3">, </span><span class="s1">str</span><span class="s3">],</span>
        <span class="s1">expected</span><span class="s3">: </span><span class="s1">str</span><span class="s3">,</span>
        <span class="s1">loglevel</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;TRACE&quot;</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Verifies table footer contains text ``expected``. 
 
        Any ``&lt;td&gt;`` element inside ``&lt;tfoot&gt;`` element is considered to 
        be part of the footer. 
 
        The table is located using the ``locator`` argument. See the 
        `Locating elements` section for details about the locator syntax. 
 
        See `Page Should Contain Element` for an explanation about the 
        ``loglevel`` argument. 
        &quot;&quot;&quot;</span>
        <span class="s1">element </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find_by_footer</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">element </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">ctx</span><span class="s3">.</span><span class="s1">log_source</span><span class="s3">(</span><span class="s1">loglevel</span><span class="s3">)</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span>
                <span class="s4">f&quot;Table '</span><span class="s2">{</span><span class="s1">locator</span><span class="s2">}</span><span class="s4">' footer did not contain text '</span><span class="s2">{</span><span class="s1">expected</span><span class="s2">}</span><span class="s4">'.&quot;</span>
            <span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">table_header_should_contain</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">locator</span><span class="s3">: </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">WebElement</span><span class="s3">, </span><span class="s1">str</span><span class="s3">],</span>
        <span class="s1">expected</span><span class="s3">: </span><span class="s1">str</span><span class="s3">,</span>
        <span class="s1">loglevel</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;TRACE&quot;</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Verifies table header contains text ``expected``. 
 
        Any ``&lt;th&gt;`` element anywhere in the table is considered to be 
        part of the header. 
 
        The table is located using the ``locator`` argument. See the 
        `Locating elements` section for details about the locator syntax. 
 
        See `Page Should Contain Element` for an explanation about the 
        ``loglevel`` argument. 
        &quot;&quot;&quot;</span>
        <span class="s1">element </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find_by_header</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">element </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">ctx</span><span class="s3">.</span><span class="s1">log_source</span><span class="s3">(</span><span class="s1">loglevel</span><span class="s3">)</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span>
                <span class="s4">f&quot;Table '</span><span class="s2">{</span><span class="s1">locator</span><span class="s2">}</span><span class="s4">' header did not contain text '</span><span class="s2">{</span><span class="s1">expected</span><span class="s2">}</span><span class="s4">'.&quot;</span>
            <span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">table_row_should_contain</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">locator</span><span class="s3">: </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">WebElement</span><span class="s3">, </span><span class="s1">str</span><span class="s3">],</span>
        <span class="s1">row</span><span class="s3">: </span><span class="s1">int</span><span class="s3">,</span>
        <span class="s1">expected</span><span class="s3">: </span><span class="s1">str</span><span class="s3">,</span>
        <span class="s1">loglevel</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;TRACE&quot;</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Verifies that table row contains text ``expected``. 
 
        The table is located using the ``locator`` argument and its column 
        found using ``column``. See the `Locating elements` section for 
        details about the locator syntax. 
 
        Row indexes start from 1. It is possible to refer to rows 
        from the end by using negative indexes so that -1 is the last row, 
        -2 is the second last, and so on. 
 
        If a table contains cells that span multiple rows, a match 
        only occurs for the uppermost row of those merged cells. 
 
        See `Page Should Contain Element` for an explanation about the 
        ``loglevel`` argument. 
        &quot;&quot;&quot;</span>
        <span class="s1">element </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find_by_row</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">row</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">element </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">ctx</span><span class="s3">.</span><span class="s1">log_source</span><span class="s3">(</span><span class="s1">loglevel</span><span class="s3">)</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span>
                <span class="s4">f&quot;Table '</span><span class="s2">{</span><span class="s1">locator</span><span class="s2">}</span><span class="s4">' row </span><span class="s2">{</span><span class="s1">row</span><span class="s2">} </span><span class="s4">did not contain text '</span><span class="s2">{</span><span class="s1">expected</span><span class="s2">}</span><span class="s4">'.&quot;</span>
            <span class="s3">)</span>

    <span class="s3">@</span><span class="s1">keyword</span>
    <span class="s2">def </span><span class="s1">table_should_contain</span><span class="s3">(</span>
        <span class="s1">self</span><span class="s3">,</span>
        <span class="s1">locator</span><span class="s3">: </span><span class="s1">Union</span><span class="s3">[</span><span class="s1">WebElement</span><span class="s3">, </span><span class="s1">str</span><span class="s3">],</span>
        <span class="s1">expected</span><span class="s3">: </span><span class="s1">str</span><span class="s3">,</span>
        <span class="s1">loglevel</span><span class="s3">: </span><span class="s1">str </span><span class="s3">= </span><span class="s4">&quot;TRACE&quot;</span><span class="s3">,</span>
    <span class="s3">):</span>
        <span class="s5">&quot;&quot;&quot;Verifies table contains text ``expected``. 
 
        The table is located using the ``locator`` argument. See the 
        `Locating elements` section for details about the locator syntax. 
 
        See `Page Should Contain Element` for an explanation about the 
        ``loglevel`` argument. 
        &quot;&quot;&quot;</span>
        <span class="s1">element </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find_by_content</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">element </span><span class="s2">is None</span><span class="s3">:</span>
            <span class="s1">self</span><span class="s3">.</span><span class="s1">ctx</span><span class="s3">.</span><span class="s1">log_source</span><span class="s3">(</span><span class="s1">loglevel</span><span class="s3">)</span>
            <span class="s2">raise </span><span class="s1">AssertionError</span><span class="s3">(</span>
                <span class="s4">f&quot;Table '</span><span class="s2">{</span><span class="s1">locator</span><span class="s2">}</span><span class="s4">' did not contain text '</span><span class="s2">{</span><span class="s1">expected</span><span class="s2">}</span><span class="s4">'.&quot;</span>
            <span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_find_by_content</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">table_locator</span><span class="s3">, </span><span class="s1">content</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find</span><span class="s3">(</span><span class="s1">table_locator</span><span class="s3">, </span><span class="s4">&quot;xpath:.//*&quot;</span><span class="s3">, </span><span class="s1">content</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_find_by_header</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">table_locator</span><span class="s3">, </span><span class="s1">content</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find</span><span class="s3">(</span><span class="s1">table_locator</span><span class="s3">, </span><span class="s4">&quot;xpath:.//th&quot;</span><span class="s3">, </span><span class="s1">content</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_find_by_footer</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">table_locator</span><span class="s3">, </span><span class="s1">content</span><span class="s3">):</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find</span><span class="s3">(</span><span class="s1">table_locator</span><span class="s3">, </span><span class="s4">&quot;xpath:.//tfoot//td&quot;</span><span class="s3">, </span><span class="s1">content</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_find_by_row</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">table_locator</span><span class="s3">, </span><span class="s1">row</span><span class="s3">, </span><span class="s1">content</span><span class="s3">):</span>
        <span class="s1">position </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_index_to_position</span><span class="s3">(</span><span class="s1">row</span><span class="s3">)</span>
        <span class="s1">locator </span><span class="s3">= </span><span class="s4">f&quot;//tr[</span><span class="s2">{</span><span class="s1">position</span><span class="s2">}</span><span class="s4">]&quot;</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find</span><span class="s3">(</span><span class="s1">table_locator</span><span class="s3">, </span><span class="s1">locator</span><span class="s3">, </span><span class="s1">content</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_find_by_column</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">table_locator</span><span class="s3">, </span><span class="s1">col</span><span class="s3">, </span><span class="s1">content</span><span class="s3">):</span>
        <span class="s1">position </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_index_to_position</span><span class="s3">(</span><span class="s1">col</span><span class="s3">)</span>
        <span class="s1">locator </span><span class="s3">= </span><span class="s4">f&quot;//tr//*[self::td or self::th][</span><span class="s2">{</span><span class="s1">position</span><span class="s2">}</span><span class="s4">]&quot;</span>
        <span class="s2">return </span><span class="s1">self</span><span class="s3">.</span><span class="s1">_find</span><span class="s3">(</span><span class="s1">table_locator</span><span class="s3">, </span><span class="s1">locator</span><span class="s3">, </span><span class="s1">content</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">_index_to_position</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">index</span><span class="s3">):</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s2">raise </span><span class="s1">ValueError</span><span class="s3">(</span><span class="s4">&quot;Row and column indexes must be non-zero.&quot;</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">&gt; </span><span class="s6">0</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s1">str</span><span class="s3">(</span><span class="s1">index</span><span class="s3">)</span>
        <span class="s2">if </span><span class="s1">index </span><span class="s3">== -</span><span class="s6">1</span><span class="s3">:</span>
            <span class="s2">return </span><span class="s4">&quot;position()=last()&quot;</span>
        <span class="s2">return </span><span class="s4">f&quot;position()=last()-</span><span class="s2">{</span><span class="s1">abs</span><span class="s3">(</span><span class="s1">index</span><span class="s3">) - </span><span class="s6">1</span><span class="s2">}</span><span class="s4">&quot;</span>

    <span class="s2">def </span><span class="s1">_find</span><span class="s3">(</span><span class="s1">self</span><span class="s3">, </span><span class="s1">table_locator</span><span class="s3">, </span><span class="s1">locator</span><span class="s3">, </span><span class="s1">content</span><span class="s3">):</span>
        <span class="s1">table </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">find_element</span><span class="s3">(</span><span class="s1">table_locator</span><span class="s3">)</span>
        <span class="s1">elements </span><span class="s3">= </span><span class="s1">self</span><span class="s3">.</span><span class="s1">find_elements</span><span class="s3">(</span><span class="s1">locator</span><span class="s3">, </span><span class="s1">parent</span><span class="s3">=</span><span class="s1">table</span><span class="s3">)</span>
        <span class="s2">for </span><span class="s1">element </span><span class="s2">in </span><span class="s1">elements</span><span class="s3">:</span>
            <span class="s2">if </span><span class="s1">content </span><span class="s2">is None</span><span class="s3">:</span>
                <span class="s2">return </span><span class="s1">element</span>
            <span class="s2">if </span><span class="s1">element</span><span class="s3">.</span><span class="s1">text </span><span class="s2">and </span><span class="s1">content </span><span class="s2">in </span><span class="s1">element</span><span class="s3">.</span><span class="s1">text</span><span class="s3">:</span>
                <span class="s2">return </span><span class="s1">element</span>
        <span class="s2">return None</span>
</pre>
</body>
</html>